# CyberVPN Backend - Environment Configuration Template
# Copy this file to .env and fill in your actual values
#
# ⚠️  SECURITY WARNING - PRODUCTION DEPLOYMENT CHECKLIST
# Before deploying to production, you MUST:
# 1. Replace ALL tokens marked _REPLACE_IN_PRODUCTION with real values
# 2. Set ENVIRONMENT=production
# 3. Set SWAGGER_ENABLED=false
# 4. Set DEBUG=false
# 5. Generate cryptographic secrets using: python scripts/generate_secrets.py

# ============================================================================
# Database Configuration
# ============================================================================
# INFO-008: PRODUCTION REQUIREMENT - Database credentials
# In production, NEVER use default/development credentials.
# Use a secrets manager (e.g., AWS Secrets Manager, HashiCorp Vault, GCP Secret Manager)
# to inject DATABASE_URL at runtime. The URL should follow the format:
# postgresql+asyncpg://<user>:<password>@<host>:<port>/<database>
#
# Example secrets manager integration (Docker/K8s):
#   - Mount secret as /run/secrets/database_url
#   - Set DATABASE_URL=$(cat /run/secrets/database_url) in entrypoint
#
# Development only - replace in production:
DATABASE_URL=postgresql+asyncpg://cybervpn:cybervpn@localhost:6767/cybervpn

# ============================================================================
# Redis Configuration
# ============================================================================
REDIS_URL=redis://localhost:6379/0

# ============================================================================
# Remnawave API Configuration
# ============================================================================
REMNAWAVE_URL=http://localhost:3000
REMNAWAVE_TOKEN=_REPLACE_IN_PRODUCTION_remnawave_token

# ============================================================================
# JWT Authentication Configuration
# ============================================================================
JWT_SECRET=_REPLACE_IN_PRODUCTION_jwt_secret_min_32_chars
JWT_ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=15
REFRESH_TOKEN_EXPIRE_DAYS=7
# JWT_ISSUER=cybervpn
# JWT_AUDIENCE=cybervpn-api

# ============================================================================
# Payment Gateway Configuration
# ============================================================================
CRYPTOBOT_TOKEN=_REPLACE_IN_PRODUCTION_cryptobot_token

# ============================================================================
# CORS Configuration
# ============================================================================
CORS_ORIGINS=http://localhost:3000,http://localhost:3001

# ============================================================================
# Application Configuration
# ============================================================================
ENVIRONMENT=development
LOG_LEVEL=INFO

# ============================================================================
# Rate Limiting Configuration
# ============================================================================
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS=100
RATE_LIMIT_WINDOW=60
TRUST_PROXY_HEADERS=false

# ============================================================================
# OTP Configuration
# ============================================================================
OTP_EXPIRATION_HOURS=3
OTP_MAX_ATTEMPTS=5
OTP_MAX_RESENDS=3
OTP_RESEND_WINDOW_HOURS=1
OTP_RESEND_COOLDOWN_SECONDS=30

# ============================================================================
# OAuth Configuration (Optional)
# ============================================================================
# GITHUB_CLIENT_ID=
# GITHUB_CLIENT_SECRET=
# TELEGRAM_BOT_TOKEN=
# TELEGRAM_BOT_USERNAME=

# ============================================================================
# SECURITY SETTINGS (from Security Remediation v1.0)
# ============================================================================

# Registration Security (CRIT-1) - Disabled by default
REGISTRATION_ENABLED=false
REGISTRATION_INVITE_REQUIRED=true
INVITE_TOKEN_EXPIRY_HOURS=24

# Debug Mode - MUST be false in production
DEBUG=false

# Rate Limit Fail Behavior (MED-1)
# false = fail-closed (reject requests on Redis error) - PRODUCTION
# true = fail-open (allow requests on Redis error) - DEVELOPMENT ONLY
RATE_LIMIT_FAIL_OPEN=false

# Mobile Rate Limit Fail Behavior (MED-4)
MOBILE_RATE_LIMIT_FAIL_OPEN=false

# JWT Algorithm Allowlist (MED-5)
JWT_ALLOWED_ALGORITHMS=HS256,HS384,HS512

# Swagger UI (MED-7) - Disabled by default for security
# Set to true only in development if needed
SWAGGER_ENABLED=false

# TOTP Encryption Key (HIGH-001) - REQUIRED IN PRODUCTION
# Generate: python -c "import secrets; print(secrets.token_urlsafe(32))"
# TOTP_ENCRYPTION_KEY=your-secure-key-here

# Trusted Proxy IPs (MED-8) - Set if behind reverse proxy
# TRUSTED_PROXY_IPS=10.0.0.1,10.0.0.2

# Token Device Binding (MED-2) - Strict fingerprint validation
ENFORCE_TOKEN_BINDING=false

# Log Sanitization (LOW-4)
LOG_SANITIZATION_ENABLED=true

# ============================================================================
# PRODUCTION CHECKLIST
# ============================================================================
# Before deploying to production, verify:
# [ ] ENVIRONMENT=production
# [ ] DEBUG=false
# [ ] SWAGGER_ENABLED=false
# [ ] TOTP_ENCRYPTION_KEY is set (unique per environment)
# [ ] JWT_SECRET is a unique cryptographic random value
# [ ] RATE_LIMIT_FAIL_OPEN=false
# [ ] MOBILE_RATE_LIMIT_FAIL_OPEN=false
# [ ] TRUSTED_PROXY_IPS configured if behind load balancer
# [ ] All tokens/secrets are production values (not development)
