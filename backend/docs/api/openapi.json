{
  "openapi": "3.1.0",
  "info": {
    "title": "CyberVPN Backend API",
    "description": "Backend API for CyberVPN admin dashboard",
    "version": "0.1.0"
  },
  "servers": [
    {
      "url": "/",
      "description": "Current server"
    }
  ],
  "paths": {
    "/api/v1/auth/login": {
      "post": {
        "tags": [
          "auth"
        ],
        "summary": "Login",
        "description": "Authenticate user and return access and refresh tokens.\n\nSecurity:\n- Brute force protection with progressive lockout\n- Constant-time response to prevent user enumeration",
        "operationId": "login_api_v1_auth_login_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/LoginRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TokenResponse"
                }
              }
            }
          },
          "401": {
            "description": "Invalid credentials"
          },
          "422": {
            "description": "Validation error"
          },
          "423": {
            "description": "Account locked"
          }
        }
      }
    },
    "/api/v1/auth/refresh": {
      "post": {
        "tags": [
          "auth"
        ],
        "summary": "Refresh Token",
        "description": "Refresh access token using refresh token.\n\nMED-002: Validates device fingerprint when ENFORCE_TOKEN_BINDING is enabled.",
        "operationId": "refresh_token_api_v1_auth_refresh_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RefreshTokenRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TokenResponse"
                }
              }
            }
          },
          "401": {
            "description": "Invalid or expired refresh token"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/auth/logout": {
      "post": {
        "tags": [
          "auth"
        ],
        "summary": "Logout",
        "description": "Logout user by invalidating refresh token.",
        "operationId": "logout_api_v1_auth_logout_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/src__presentation__api__v1__auth__schemas__LogoutRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "204": {
            "description": "Successful Response"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/auth/logout-all": {
      "post": {
        "tags": [
          "auth"
        ],
        "summary": "Logout All Devices",
        "description": "Logout from all devices by revoking all user tokens (HIGH-6).\n\nRevokes all access and refresh tokens for the current user.",
        "operationId": "logout_all_devices_api_v1_auth_logout_all_post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LogoutAllResponse"
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated"
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ]
      }
    },
    "/api/v1/auth/me": {
      "get": {
        "tags": [
          "auth"
        ],
        "summary": "Get Me",
        "description": "Get current authenticated user information.",
        "operationId": "get_me_api_v1_auth_me_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AdminUserResponse"
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated"
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ]
      },
      "delete": {
        "tags": [
          "auth"
        ],
        "summary": "Delete Account",
        "description": "Soft-delete the current user's account (FEAT-03).\n\nSets is_active=False and deleted_at, then revokes all refresh tokens\nand JWT access tokens. The user will be immediately logged out of all\ndevices.",
        "operationId": "delete_account_api_v1_auth_me_delete",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DeleteAccountResponse"
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated"
          },
          "404": {
            "description": "User not found"
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ]
      }
    },
    "/api/v1/auth/verify-otp": {
      "post": {
        "tags": [
          "auth"
        ],
        "summary": "Verify Otp",
        "description": "Verify OTP code for email verification.\n\nOn success:\n1. Activates user account\n2. Creates user in Remnawave VPN backend\n3. Returns access/refresh tokens (auto-login)",
        "operationId": "verify_otp_api_v1_auth_verify_otp_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/VerifyOtpRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/VerifyOtpResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid or expired OTP code"
          },
          "429": {
            "description": "Too many attempts"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/auth/resend-otp": {
      "post": {
        "tags": [
          "auth"
        ],
        "summary": "Resend Otp",
        "description": "Resend OTP verification code.\n\nUses Brevo (secondary provider) for resend requests.\nRate limited to 3 resends per hour per email.",
        "operationId": "resend_otp_api_v1_auth_resend_otp_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ResendOtpRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ResendOtpResponse"
                }
              }
            }
          },
          "429": {
            "description": "Rate limit exceeded"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/auth/magic-link": {
      "post": {
        "tags": [
          "auth"
        ],
        "summary": "Request Magic Link",
        "description": "Request a magic link for passwordless login.\n\nAlways returns success to prevent email enumeration.",
        "operationId": "request_magic_link_api_v1_auth_magic_link_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/MagicLinkRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MagicLinkResponse"
                }
              }
            }
          },
          "429": {
            "description": "Rate limit exceeded"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/auth/magic-link/verify": {
      "post": {
        "tags": [
          "auth"
        ],
        "summary": "Verify Magic Link",
        "description": "Verify magic link token and return JWT tokens.\n\nIf user doesn't exist, creates a new account with verified email.",
        "operationId": "verify_magic_link_api_v1_auth_magic_link_verify_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/MagicLinkVerifyRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TokenResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid or expired token"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/auth/telegram/miniapp": {
      "post": {
        "tags": [
          "auth"
        ],
        "summary": "Telegram Miniapp Auth",
        "description": "Authenticate via Telegram Mini App initData.\n\nValidates HMAC-SHA256 signature, checks auth_date freshness,\nauto-registers or auto-logs-in the Telegram user.",
        "operationId": "telegram_miniapp_auth_api_v1_auth_telegram_miniapp_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/TelegramMiniAppRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TelegramMiniAppResponse"
                }
              }
            }
          },
          "401": {
            "description": "Invalid or expired initData"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/auth/telegram/bot-link": {
      "post": {
        "tags": [
          "auth"
        ],
        "summary": "Telegram Bot Link Auth",
        "description": "Authenticate via one-time Telegram bot login link token.\n\nThe bot generates a /login link containing a one-time token.\nThis endpoint consumes the token and issues JWT tokens.",
        "operationId": "telegram_bot_link_auth_api_v1_auth_telegram_bot_link_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/TelegramBotLinkRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TelegramBotLinkResponse"
                }
              }
            }
          },
          "401": {
            "description": "Invalid or expired login token"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/auth/telegram/generate-login-link": {
      "post": {
        "tags": [
          "auth"
        ],
        "summary": "Generate Login Link",
        "description": "Generate a one-time Telegram bot login link (admin/bot-only).\n\nCreates a token in Redis with 5-minute TTL, returns a deep link URL.",
        "operationId": "generate_login_link_api_v1_auth_telegram_generate_login_link_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/GenerateLoginLinkRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GenerateLoginLinkResponse"
                }
              }
            }
          },
          "403": {
            "description": "Insufficient permissions"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ]
      }
    },
    "/api/v1/auth/forgot-password": {
      "post": {
        "tags": [
          "auth"
        ],
        "summary": "Forgot Password",
        "description": "Request password reset OTP code.\n\nAlways returns success to prevent email enumeration.",
        "operationId": "forgot_password_api_v1_auth_forgot_password_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ForgotPasswordRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ForgotPasswordResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/auth/reset-password": {
      "post": {
        "tags": [
          "auth"
        ],
        "summary": "Reset Password",
        "description": "Reset password using OTP code from forgot-password email.",
        "operationId": "reset_password_api_v1_auth_reset_password_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ResetPasswordRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ResetPasswordResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid or expired OTP code"
          },
          "429": {
            "description": "Too many attempts"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/auth/register": {
      "post": {
        "tags": [
          "auth"
        ],
        "summary": "Register",
        "description": "Register a new user with email verification.\n\nCreates user with is_active=False, is_email_verified=False.\nSends OTP verification email to the provided address.\nUser must verify email before logging in.\n\nSecurity:\n- Registration is disabled by default (REGISTRATION_ENABLED=false)\n- When enabled with invite-only mode, requires valid invite token\n- All registration attempts are logged for audit",
        "operationId": "register_api_v1_auth_register_post",
        "parameters": [
          {
            "name": "invite_token",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "description": "Invite token required for registration when invite-only mode is enabled",
              "title": "Invite Token"
            },
            "description": "Invite token required for registration when invite-only mode is enabled"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RegisterRequest"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RegisterResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/mobile/auth/register": {
      "post": {
        "tags": [
          "mobile-auth"
        ],
        "summary": "Register",
        "description": "Register a new mobile app user.\n\nCreates a new user account with the provided email and password,\nregisters the device, and returns authentication tokens.\n\n**Error Codes:**\n- `EMAIL_EXISTS`: Email already registered (409)",
        "operationId": "register_api_v1_mobile_auth_register_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/src__presentation__api__v1__mobile_auth__schemas__RegisterRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuthResponse"
                }
              }
            }
          },
          "409": {
            "description": "Email already registered",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MobileAuthError"
                }
              }
            }
          },
          "429": {
            "description": "Too many registration attempts (limit: 3/min per IP)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MobileAuthError"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/mobile/auth/login": {
      "post": {
        "tags": [
          "mobile-auth"
        ],
        "summary": "Login",
        "description": "Authenticate a mobile app user.\n\nValidates credentials, updates device registration, and returns tokens.\n\n**Error Codes:**\n- `INVALID_CREDENTIALS`: Wrong email/password or account disabled (401)",
        "operationId": "login_api_v1_mobile_auth_login_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/src__presentation__api__v1__mobile_auth__schemas__LoginRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuthResponse"
                }
              }
            }
          },
          "401": {
            "description": "Invalid credentials",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MobileAuthError"
                }
              }
            }
          },
          "429": {
            "description": "Too many login attempts (limit: 5/min per device)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MobileAuthError"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/mobile/auth/refresh": {
      "post": {
        "tags": [
          "mobile-auth"
        ],
        "summary": "Refresh Token",
        "description": "Refresh authentication tokens.\n\nExchanges a valid refresh token for new access and refresh tokens.\n\n**Error Codes:**\n- `INVALID_TOKEN`: Refresh token is invalid, expired, or device mismatch (401)",
        "operationId": "refresh_token_api_v1_mobile_auth_refresh_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/src__presentation__api__v1__mobile_auth__schemas__RefreshTokenRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/src__presentation__api__v1__mobile_auth__schemas__TokenResponse"
                }
              }
            }
          },
          "401": {
            "description": "Invalid or expired refresh token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MobileAuthError"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/mobile/auth/logout": {
      "post": {
        "tags": [
          "mobile-auth"
        ],
        "summary": "Logout",
        "description": "Logout a mobile app user.\n\nRevokes the refresh token and optionally removes device registration.\n\n**Error Codes:**\n- `INVALID_TOKEN`: Token is invalid or device mismatch (401)",
        "operationId": "logout_api_v1_mobile_auth_logout_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/LogoutRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "204": {
            "description": "Successful Response"
          },
          "401": {
            "description": "Invalid token",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MobileAuthError"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/mobile/auth/me": {
      "get": {
        "tags": [
          "mobile-auth"
        ],
        "summary": "Get Me",
        "description": "Get current user profile.\n\nReturns the authenticated user's profile with subscription information.\n\n**Error Codes:**\n- `UNAUTHORIZED`: Not authenticated (401)\n- `USER_NOT_FOUND`: User account not found (404)",
        "operationId": "get_me_api_v1_mobile_auth_me_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserResponse"
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MobileAuthError"
                }
              }
            }
          },
          "404": {
            "description": "User not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MobileAuthError"
                }
              }
            }
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ]
      }
    },
    "/api/v1/mobile/auth/device": {
      "post": {
        "tags": [
          "mobile-auth"
        ],
        "summary": "Register Device",
        "description": "Register or update a mobile device.\n\nRegisters a new device or updates existing device information.\nUsed for push notifications and session management.\n\n**Error Codes:**\n- `UNAUTHORIZED`: Not authenticated (401)",
        "operationId": "register_device_api_v1_mobile_auth_device_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DeviceRegistrationRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DeviceResponse"
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MobileAuthError"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ]
      }
    },
    "/api/v1/mobile/auth/telegram/callback": {
      "post": {
        "tags": [
          "mobile-auth"
        ],
        "summary": "Telegram Callback",
        "description": "Authenticate via Telegram Login Widget.\n\nValidates Telegram OAuth callback data and creates or links user account.\nNew users are auto-created from Telegram profile data.\n\n**Error Codes:**\n- `INVALID_TELEGRAM_AUTH`: Invalid signature or malformed data (400)\n- `TELEGRAM_AUTH_EXPIRED`: auth_date is older than 24 hours (401)",
        "operationId": "telegram_callback_api_v1_mobile_auth_telegram_callback_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/TelegramAuthRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Existing user authenticated via Telegram",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuthResponse"
                }
              }
            }
          },
          "201": {
            "description": "New user created and authenticated via Telegram",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuthResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid Telegram authentication data",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MobileAuthError"
                }
              }
            }
          },
          "401": {
            "description": "Telegram authentication expired or invalid signature",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MobileAuthError"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/oauth/telegram/authorize": {
      "get": {
        "tags": [
          "oauth"
        ],
        "summary": "Telegram Authorize",
        "description": "Get Telegram OAuth authorization URL with CSRF state token.\n\nThe state token must be included in the callback request.",
        "operationId": "telegram_authorize_api_v1_oauth_telegram_authorize_get",
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "parameters": [
          {
            "name": "redirect_uri",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "description": "Redirect URI after authentication",
              "title": "Redirect Uri"
            },
            "description": "Redirect URI after authentication"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OAuthAuthorizeResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/oauth/github/authorize": {
      "get": {
        "tags": [
          "oauth"
        ],
        "summary": "Github Authorize",
        "description": "Get GitHub OAuth authorization URL with CSRF state token.\n\nThe state token must be included in the callback request.",
        "operationId": "github_authorize_api_v1_oauth_github_authorize_get",
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "parameters": [
          {
            "name": "redirect_uri",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "description": "Redirect URI after authentication",
              "title": "Redirect Uri"
            },
            "description": "Redirect URI after authentication"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OAuthAuthorizeResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/oauth/telegram/callback": {
      "post": {
        "tags": [
          "oauth"
        ],
        "summary": "Telegram Callback",
        "description": "Process Telegram OAuth callback and link account.\n\nValidates:\n1. CSRF state token\n2. HMAC-SHA256 signature using bot token\n3. auth_date is within acceptable range (24 hours)",
        "operationId": "telegram_callback_api_v1_oauth_telegram_callback_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/TelegramCallbackRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OAuthLinkResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ]
      }
    },
    "/api/v1/oauth/github/callback": {
      "post": {
        "tags": [
          "oauth"
        ],
        "summary": "Github Callback",
        "description": "Process GitHub OAuth callback and link account.\n\nValidates:\n1. CSRF state token\n2. Exchanges code for access token via GitHub API\n3. Fetches user info from GitHub API",
        "operationId": "github_callback_api_v1_oauth_github_callback_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/GitHubCallbackRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OAuthLinkResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ]
      }
    },
    "/api/v1/oauth/{provider}": {
      "delete": {
        "tags": [
          "oauth"
        ],
        "summary": "Unlink Provider",
        "description": "Unlink a social account from the current user.\n\nProvider must be one of: telegram, github",
        "operationId": "unlink_provider_api_v1_oauth__provider__delete",
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "parameters": [
          {
            "name": "provider",
            "in": "path",
            "required": true,
            "schema": {
              "$ref": "#/components/schemas/OAuthProvider"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OAuthLinkResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/oauth/{provider}/login": {
      "get": {
        "tags": [
          "oauth"
        ],
        "summary": "Oauth Login Authorize",
        "description": "Get OAuth authorization URL for login (no authentication required).\n\nGenerates state token and PKCE challenge (when supported).",
        "operationId": "oauth_login_authorize_api_v1_oauth__provider__login_get",
        "parameters": [
          {
            "name": "provider",
            "in": "path",
            "required": true,
            "schema": {
              "$ref": "#/components/schemas/OAuthProvider"
            }
          },
          {
            "name": "redirect_uri",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "description": "Redirect URI after authentication",
              "title": "Redirect Uri"
            },
            "description": "Redirect URI after authentication"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OAuthAuthorizeResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/oauth/{provider}/login/callback": {
      "post": {
        "tags": [
          "oauth"
        ],
        "summary": "Oauth Login Callback",
        "description": "Process OAuth login callback and return JWT tokens (no authentication required).\n\nValidates state, exchanges code with provider, finds or creates user.",
        "operationId": "oauth_login_callback_api_v1_oauth__provider__login_callback_post",
        "parameters": [
          {
            "name": "provider",
            "in": "path",
            "required": true,
            "schema": {
              "$ref": "#/components/schemas/OAuthProvider"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/OAuthLoginCallbackRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OAuthLoginResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/2fa/reauth": {
      "post": {
        "tags": [
          "two-factor"
        ],
        "summary": "Reauthenticate",
        "description": "Re-authenticate with password for sensitive 2FA operations.\n\nRequired before:\n- Setting up 2FA\n- Disabling 2FA\n\nValid for 5 minutes.",
        "operationId": "reauthenticate_api_v1_2fa_reauth_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ReauthRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReauthResponse"
                }
              }
            }
          },
          "401": {
            "description": "Invalid password"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ]
      }
    },
    "/api/v1/2fa/setup": {
      "post": {
        "tags": [
          "two-factor"
        ],
        "summary": "Setup 2Fa",
        "description": "Begin 2FA setup process.\n\nRequires recent password re-authentication (call /2fa/reauth first).\n\nReturns a TOTP secret and QR URI. The secret is NOT stored in the database\nuntil verified with /2fa/verify.",
        "operationId": "setup_2fa_api_v1_2fa_setup_post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TwoFactorSetupResponse"
                }
              }
            }
          },
          "400": {
            "description": "2FA already enabled"
          },
          "401": {
            "description": "Re-authentication required"
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ]
      }
    },
    "/api/v1/2fa/verify": {
      "post": {
        "tags": [
          "two-factor"
        ],
        "summary": "Verify 2Fa",
        "description": "Verify TOTP code and enable 2FA.\n\nThis persists the TOTP secret to the database after successful verification.",
        "operationId": "verify_2fa_api_v1_2fa_verify_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/TwoFactorVerifyRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TwoFactorStatusResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid verification code or no pending setup"
          },
          "429": {
            "description": "Too many verification attempts"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ]
      }
    },
    "/api/v1/2fa/validate": {
      "post": {
        "tags": [
          "two-factor"
        ],
        "summary": "Validate 2Fa",
        "description": "Validate a 2FA code without changing state.\n\nRate limited to prevent brute force attacks.",
        "operationId": "validate_2fa_api_v1_2fa_validate_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/VerifyCodeRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TwoFactorValidateResponse"
                }
              }
            }
          },
          "400": {
            "description": "2FA not enabled"
          },
          "429": {
            "description": "Too many verification attempts"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ]
      }
    },
    "/api/v1/2fa/disable": {
      "delete": {
        "tags": [
          "two-factor"
        ],
        "summary": "Disable 2Fa",
        "description": "Disable two-factor authentication.\n\nRequires:\n1. Current password\n2. Current TOTP code\n\nReturns one-time recovery codes (for emergency access if needed later).",
        "operationId": "disable_2fa_api_v1_2fa_disable_delete",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/TwoFactorDisableRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TwoFactorStatusResponse"
                }
              }
            }
          },
          "400": {
            "description": "2FA not enabled"
          },
          "401": {
            "description": "Invalid password or TOTP code"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ]
      }
    },
    "/api/v1/2fa/status": {
      "get": {
        "tags": [
          "two-factor"
        ],
        "summary": "Get 2Fa Status",
        "description": "Get current 2FA status for the user.",
        "operationId": "get_2fa_status_api_v1_2fa_status_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TwoFactorStatusResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ]
      }
    },
    "/api/v1/users/": {
      "get": {
        "tags": [
          "users"
        ],
        "summary": "List Users",
        "description": "List all VPN users with pagination.",
        "operationId": "list_users_api_v1_users__get",
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "parameters": [
          {
            "name": "page",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "minimum": 1,
              "description": "Page number",
              "default": 1,
              "title": "Page"
            },
            "description": "Page number"
          },
          {
            "name": "page_size",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 100,
              "minimum": 1,
              "description": "Items per page",
              "default": 20,
              "title": "Page Size"
            },
            "description": "Items per page"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserListResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": [
          "users"
        ],
        "summary": "Create User",
        "description": "Create a new VPN user.",
        "operationId": "create_user_api_v1_users__post",
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateUserRequest"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/src__presentation__api__v1__users__schemas__UserResponse"
                }
              }
            }
          },
          "409": {
            "description": "User already exists"
          },
          "422": {
            "description": "Validation error"
          }
        }
      }
    },
    "/api/v1/users/{user_id}": {
      "get": {
        "tags": [
          "users"
        ],
        "summary": "Get User",
        "description": "Get a specific VPN user by UUID.",
        "operationId": "get_user_api_v1_users__user_id__get",
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "parameters": [
          {
            "name": "user_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "title": "User Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/src__presentation__api__v1__users__schemas__UserResponse"
                }
              }
            }
          },
          "404": {
            "description": "User not found"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": [
          "users"
        ],
        "summary": "Update User",
        "description": "Update a VPN user.",
        "operationId": "update_user_api_v1_users__user_id__put",
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "parameters": [
          {
            "name": "user_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "title": "User Id"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateUserRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/src__presentation__api__v1__users__schemas__UserResponse"
                }
              }
            }
          },
          "404": {
            "description": "User not found"
          },
          "422": {
            "description": "Validation error"
          }
        }
      },
      "delete": {
        "tags": [
          "users"
        ],
        "summary": "Delete User",
        "description": "Delete a VPN user.",
        "operationId": "delete_user_api_v1_users__user_id__delete",
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "parameters": [
          {
            "name": "user_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "title": "User Id"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Successful Response"
          },
          "404": {
            "description": "User not found"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/servers/": {
      "get": {
        "tags": [
          "servers"
        ],
        "summary": "List Servers",
        "description": "List all Remnawave VPN servers.",
        "operationId": "list_servers_api_v1_servers__get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "items": {
                    "$ref": "#/components/schemas/ServerResponse"
                  },
                  "type": "array",
                  "title": "Response List Servers Api V1 Servers  Get"
                }
              }
            }
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ]
      },
      "post": {
        "tags": [
          "servers"
        ],
        "summary": "Create Server",
        "description": "Create a new Remnawave VPN server.",
        "operationId": "create_server_api_v1_servers__post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateServerRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ServerResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ]
      }
    },
    "/api/v1/servers/stats": {
      "get": {
        "tags": [
          "servers"
        ],
        "summary": "Get Server Stats",
        "description": "Get Remnawave server statistics by status.",
        "operationId": "get_server_stats_api_v1_servers_stats_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ServerStatsResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ]
      }
    },
    "/api/v1/servers/{server_id}": {
      "get": {
        "tags": [
          "servers"
        ],
        "summary": "Get Server",
        "description": "Get a specific Remnawave VPN server by UUID.",
        "operationId": "get_server_api_v1_servers__server_id__get",
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "parameters": [
          {
            "name": "server_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "title": "Server Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ServerResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": [
          "servers"
        ],
        "summary": "Update Server",
        "description": "Update a Remnawave VPN server.",
        "operationId": "update_server_api_v1_servers__server_id__put",
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "parameters": [
          {
            "name": "server_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "title": "Server Id"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateServerRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ServerResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "servers"
        ],
        "summary": "Delete Server",
        "description": "Delete a Remnawave VPN server.",
        "operationId": "delete_server_api_v1_servers__server_id__delete",
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "parameters": [
          {
            "name": "server_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "format": "uuid",
              "title": "Server Id"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Successful Response"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/subscriptions/": {
      "get": {
        "tags": [
          "subscriptions"
        ],
        "summary": "List Subscription Templates",
        "description": "List all subscription templates (admin only)",
        "operationId": "list_subscription_templates_api_v1_subscriptions__get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "items": {
                    "$ref": "#/components/schemas/RemnawaveSubscriptionResponse"
                  },
                  "type": "array",
                  "title": "Response List Subscription Templates Api V1 Subscriptions  Get"
                }
              }
            }
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ]
      },
      "post": {
        "tags": [
          "subscriptions"
        ],
        "summary": "Create Subscription Template",
        "description": "Create a new subscription template (admin only)",
        "operationId": "create_subscription_template_api_v1_subscriptions__post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateSubscriptionTemplateRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RemnawaveSubscriptionResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ]
      }
    },
    "/api/v1/subscriptions/{uuid}": {
      "get": {
        "tags": [
          "subscriptions"
        ],
        "summary": "Get Subscription Template",
        "description": "Get subscription template details",
        "operationId": "get_subscription_template_api_v1_subscriptions__uuid__get",
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "parameters": [
          {
            "name": "uuid",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RemnawaveSubscriptionResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": [
          "subscriptions"
        ],
        "summary": "Update Subscription Template",
        "description": "Update subscription template (admin only)",
        "operationId": "update_subscription_template_api_v1_subscriptions__uuid__put",
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "parameters": [
          {
            "name": "uuid",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Uuid"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateSubscriptionTemplateRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RemnawaveSubscriptionResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "subscriptions"
        ],
        "summary": "Delete Subscription Template",
        "description": "Delete subscription template (admin only)",
        "operationId": "delete_subscription_template_api_v1_subscriptions__uuid__delete",
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "parameters": [
          {
            "name": "uuid",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/StatusMessageResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/subscriptions/config/{user_uuid}": {
      "get": {
        "tags": [
          "subscriptions"
        ],
        "summary": "Generate Config",
        "description": "Generate VPN configuration for a user",
        "operationId": "generate_config_api_v1_subscriptions_config__user_uuid__get",
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "parameters": [
          {
            "name": "user_uuid",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "User Uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RemnawaveSubscriptionConfigResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/plans/": {
      "get": {
        "tags": [
          "plans"
        ],
        "summary": "List Plans",
        "description": "List all available subscription plans (public)",
        "operationId": "list_plans_api_v1_plans__get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "items": {
                    "$ref": "#/components/schemas/RemnavwavePlanResponse"
                  },
                  "type": "array",
                  "title": "Response List Plans Api V1 Plans  Get"
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": [
          "plans"
        ],
        "summary": "Create Plan",
        "description": "Create a new subscription plan (admin only)",
        "operationId": "create_plan_api_v1_plans__post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreatePlanRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RemnavwavePlanResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ]
      }
    },
    "/api/v1/plans/{uuid}": {
      "put": {
        "tags": [
          "plans"
        ],
        "summary": "Update Plan",
        "description": "Update subscription plan (admin only)",
        "operationId": "update_plan_api_v1_plans__uuid__put",
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "parameters": [
          {
            "name": "uuid",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Uuid"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdatePlanRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RemnavwavePlanResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "plans"
        ],
        "summary": "Delete Plan",
        "description": "Delete subscription plan (admin only)",
        "operationId": "delete_plan_api_v1_plans__uuid__delete",
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "parameters": [
          {
            "name": "uuid",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/StatusMessageResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/payments/crypto/invoice": {
      "post": {
        "tags": [
          "payments"
        ],
        "summary": "Create Crypto Invoice",
        "description": "Create a new cryptocurrency invoice.",
        "operationId": "create_crypto_invoice_api_v1_payments_crypto_invoice_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateInvoiceRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/InvoiceResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid payment parameters"
          },
          "422": {
            "description": "Validation error"
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ]
      }
    },
    "/api/v1/payments/crypto/invoice/{invoice_id}": {
      "get": {
        "tags": [
          "payments"
        ],
        "summary": "Get Crypto Invoice",
        "description": "Get a crypto invoice by ID.",
        "operationId": "get_crypto_invoice_api_v1_payments_crypto_invoice__invoice_id__get",
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "parameters": [
          {
            "name": "invoice_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Invoice Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/InvoiceResponse"
                }
              }
            }
          },
          "404": {
            "description": "Invoice not found"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/payments/history": {
      "get": {
        "tags": [
          "payments"
        ],
        "summary": "Get Payment History",
        "description": "Get payment history with optional user filter.",
        "operationId": "get_payment_history_api_v1_payments_history_get",
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "parameters": [
          {
            "name": "user_uuid",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string",
                  "format": "uuid"
                },
                {
                  "type": "null"
                }
              ],
              "description": "Filter by user UUID",
              "title": "User Uuid"
            },
            "description": "Filter by user UUID"
          },
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "minimum": 0,
              "description": "Pagination offset",
              "default": 0,
              "title": "Offset"
            },
            "description": "Pagination offset"
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 100,
              "minimum": 1,
              "description": "Pagination limit",
              "default": 50,
              "title": "Limit"
            },
            "description": "Pagination limit"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PaymentHistoryResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/billing/": {
      "get": {
        "tags": [
          "billing"
        ],
        "summary": "Get Billing Info",
        "description": "Get user billing information and history",
        "operationId": "get_billing_info_api_v1_billing__get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "items": {
                    "$ref": "#/components/schemas/RemnavwaveBillingRecordResponse"
                  },
                  "type": "array",
                  "title": "Response Get Billing Info Api V1 Billing  Get"
                }
              }
            }
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ]
      },
      "post": {
        "tags": [
          "billing"
        ],
        "summary": "Create Payment",
        "description": "Create a new payment transaction",
        "operationId": "create_payment_api_v1_billing__post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreatePaymentRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RemnavwaveBillingRecordResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ]
      }
    },
    "/api/v1/monitoring/health": {
      "get": {
        "tags": [
          "monitoring"
        ],
        "summary": "Health Check",
        "description": "Authenticated system health check endpoint.",
        "operationId": "health_check_api_v1_monitoring_health_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HealthResponse"
                }
              }
            }
          },
          "503": {
            "description": "One or more components unhealthy"
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ]
      }
    },
    "/api/v1/monitoring/stats": {
      "get": {
        "tags": [
          "monitoring"
        ],
        "summary": "Get System Stats",
        "description": "Get bandwidth statistics (authenticated).",
        "operationId": "get_system_stats_api_v1_monitoring_stats_get",
        "responses": {
          "200": {
            "description": "Server bandwidth statistics",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/StatsResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ]
      }
    },
    "/api/v1/monitoring/bandwidth": {
      "get": {
        "tags": [
          "monitoring"
        ],
        "summary": "Get Bandwidth Analytics",
        "description": "Get bandwidth analytics for a specific period (authenticated).",
        "operationId": "get_bandwidth_analytics_api_v1_monitoring_bandwidth_get",
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "parameters": [
          {
            "name": "period",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "maxLength": 50,
              "description": "Period for analytics: today, week, month",
              "default": "today",
              "title": "Period"
            },
            "description": "Period for analytics: today, week, month"
          }
        ],
        "responses": {
          "200": {
            "description": "Bandwidth analytics data",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BandwidthResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/admin/audit-log": {
      "get": {
        "tags": [
          "admin"
        ],
        "summary": "Get Audit Logs",
        "description": "Get audit logs (admin only).",
        "operationId": "get_audit_logs_api_v1_admin_audit_log_get",
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "parameters": [
          {
            "name": "page",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "minimum": 1,
              "description": "Page number",
              "default": 1,
              "title": "Page"
            },
            "description": "Page number"
          },
          {
            "name": "page_size",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 100,
              "minimum": 1,
              "description": "Items per page",
              "default": 20,
              "title": "Page Size"
            },
            "description": "Items per page"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/AuditLogResponse"
                  },
                  "title": "Response Get Audit Logs Api V1 Admin Audit Log Get"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/admin/webhook-log": {
      "get": {
        "tags": [
          "admin"
        ],
        "summary": "Get Webhook Logs",
        "description": "Get webhook logs (admin only).",
        "operationId": "get_webhook_logs_api_v1_admin_webhook_log_get",
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "parameters": [
          {
            "name": "page",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "minimum": 1,
              "description": "Page number",
              "default": 1,
              "title": "Page"
            },
            "description": "Page number"
          },
          {
            "name": "page_size",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 100,
              "minimum": 1,
              "description": "Items per page",
              "default": 20,
              "title": "Page Size"
            },
            "description": "Items per page"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/WebhookLogResponse"
                  },
                  "title": "Response Get Webhook Logs Api V1 Admin Webhook Log Get"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/admin/invites": {
      "get": {
        "tags": [
          "admin",
          "invites"
        ],
        "summary": "List Invites",
        "description": "List all active invite tokens.\n\n- Requires MANAGE_INVITES permission\n- Returns token details including remaining TTL",
        "operationId": "list_invites_api_v1_admin_invites_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ListInvitesResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ]
      },
      "post": {
        "tags": [
          "admin",
          "invites"
        ],
        "summary": "Create Invite",
        "description": "Create a new invite token for user registration.\n\n- Requires MANAGE_INVITES permission (ADMIN or SUPER_ADMIN role)\n- Tokens are single-use and expire after 24 hours by default\n- Optionally restrict invite to a specific email address",
        "operationId": "create_invite_api_v1_admin_invites_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateInviteRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CreateInviteResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ]
      }
    },
    "/api/v1/admin/invites/{token}": {
      "delete": {
        "tags": [
          "admin",
          "invites"
        ],
        "summary": "Revoke Invite",
        "description": "Revoke an invite token.\n\n- Requires MANAGE_INVITES permission\n- Token will be immediately invalidated",
        "operationId": "revoke_invite_api_v1_admin_invites__token__delete",
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "parameters": [
          {
            "name": "token",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Token"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Successful Response"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/webhooks/remnawave": {
      "post": {
        "tags": [
          "webhooks"
        ],
        "summary": "Remnawave Webhook",
        "description": "Handle webhook callbacks from Remnawave VPN service.",
        "operationId": "remnawave_webhook_api_v1_webhooks_remnawave_post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": {
                    "type": "string"
                  },
                  "type": "object",
                  "title": "Response Remnawave Webhook Api V1 Webhooks Remnawave Post"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/webhooks/cryptobot": {
      "post": {
        "tags": [
          "webhooks"
        ],
        "summary": "Cryptobot Webhook",
        "description": "Handle webhook callbacks from CryptoBot payment service.",
        "operationId": "cryptobot_webhook_api_v1_webhooks_cryptobot_post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": {
                    "type": "string"
                  },
                  "type": "object",
                  "title": "Response Cryptobot Webhook Api V1 Webhooks Cryptobot Post"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/telegram/user/{telegram_id}": {
      "get": {
        "tags": [
          "telegram"
        ],
        "summary": "Get Telegram User",
        "description": "Get Telegram user information.",
        "operationId": "get_telegram_user_api_v1_telegram_user__telegram_id__get",
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "parameters": [
          {
            "name": "telegram_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "title": "Telegram Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TelegramUserResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/telegram/user/{telegram_id}/subscription": {
      "post": {
        "tags": [
          "telegram"
        ],
        "summary": "Create Subscription",
        "description": "Create a subscription for a Telegram user.",
        "operationId": "create_subscription_api_v1_telegram_user__telegram_id__subscription_post",
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "parameters": [
          {
            "name": "telegram_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "title": "Telegram Id"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateSubscriptionRequest"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response Create Subscription Api V1 Telegram User  Telegram Id  Subscription Post"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/telegram/user/{telegram_id}/config": {
      "get": {
        "tags": [
          "telegram"
        ],
        "summary": "Get User Config",
        "description": "Get VPN configuration for a Telegram user.",
        "operationId": "get_user_config_api_v1_telegram_user__telegram_id__config_get",
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "parameters": [
          {
            "name": "telegram_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "title": "Telegram Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ConfigResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/hosts/": {
      "get": {
        "tags": [
          "hosts"
        ],
        "summary": "List Hosts",
        "description": "List all VPN hosts (admin only)",
        "operationId": "list_hosts_api_v1_hosts__get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "items": {
                    "$ref": "#/components/schemas/HostResponse"
                  },
                  "type": "array",
                  "title": "Response List Hosts Api V1 Hosts  Get"
                }
              }
            }
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ]
      },
      "post": {
        "tags": [
          "hosts"
        ],
        "summary": "Create Host",
        "description": "Create a new VPN host (admin only)",
        "operationId": "create_host_api_v1_hosts__post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateHostRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HostResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ]
      }
    },
    "/api/v1/hosts/{uuid}": {
      "get": {
        "tags": [
          "hosts"
        ],
        "summary": "Get Host",
        "description": "Get host details (admin only)",
        "operationId": "get_host_api_v1_hosts__uuid__get",
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "parameters": [
          {
            "name": "uuid",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HostResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": [
          "hosts"
        ],
        "summary": "Update Host",
        "description": "Update host configuration (admin only)",
        "operationId": "update_host_api_v1_hosts__uuid__put",
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "parameters": [
          {
            "name": "uuid",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Uuid"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateHostRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HostResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "hosts"
        ],
        "summary": "Delete Host",
        "description": "Delete a host (admin only)",
        "operationId": "delete_host_api_v1_hosts__uuid__delete",
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "parameters": [
          {
            "name": "uuid",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/StatusMessageResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/config-profiles/": {
      "get": {
        "tags": [
          "config-profiles"
        ],
        "summary": "List Config Profiles",
        "description": "List available configuration profiles",
        "operationId": "list_config_profiles_api_v1_config_profiles__get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "items": {
                    "$ref": "#/components/schemas/RemnawaveConfigProfileResponse"
                  },
                  "type": "array",
                  "title": "Response List Config Profiles Api V1 Config Profiles  Get"
                }
              }
            }
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ]
      },
      "post": {
        "tags": [
          "config-profiles"
        ],
        "summary": "Create Config Profile",
        "description": "Create a new configuration profile (admin only)",
        "operationId": "create_config_profile_api_v1_config_profiles__post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateConfigProfileRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RemnawaveConfigProfileResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ]
      }
    },
    "/api/v1/inbounds/": {
      "get": {
        "tags": [
          "inbounds"
        ],
        "summary": "List Inbounds",
        "description": "List all inbound configurations (admin only)",
        "operationId": "list_inbounds_api_v1_inbounds__get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "items": {
                    "$ref": "#/components/schemas/RemnawaveInboundResponse"
                  },
                  "type": "array",
                  "title": "Response List Inbounds Api V1 Inbounds  Get"
                }
              }
            }
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ]
      }
    },
    "/api/v1/inbounds/{uuid}": {
      "get": {
        "tags": [
          "inbounds"
        ],
        "summary": "Get Inbound",
        "description": "Get inbound configuration details (admin only)",
        "operationId": "get_inbound_api_v1_inbounds__uuid__get",
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "parameters": [
          {
            "name": "uuid",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Uuid"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RemnawaveInboundResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/squads/internal": {
      "get": {
        "tags": [
          "squads"
        ],
        "summary": "List Internal Squads",
        "description": "List internal squads (admin only)",
        "operationId": "list_internal_squads_api_v1_squads_internal_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "items": {
                    "$ref": "#/components/schemas/RemnawaveSquadResponse"
                  },
                  "type": "array",
                  "title": "Response List Internal Squads Api V1 Squads Internal Get"
                }
              }
            }
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ]
      }
    },
    "/api/v1/squads/external": {
      "get": {
        "tags": [
          "squads"
        ],
        "summary": "List External Squads",
        "description": "List external squads",
        "operationId": "list_external_squads_api_v1_squads_external_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "items": {
                    "$ref": "#/components/schemas/RemnawaveSquadResponse"
                  },
                  "type": "array",
                  "title": "Response List External Squads Api V1 Squads External Get"
                }
              }
            }
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ]
      }
    },
    "/api/v1/squads/": {
      "post": {
        "tags": [
          "squads"
        ],
        "summary": "Create Squad",
        "description": "Create a new squad (admin only)",
        "operationId": "create_squad_api_v1_squads__post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateSquadRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RemnawaveSquadResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ]
      }
    },
    "/api/v1/snippets/": {
      "get": {
        "tags": [
          "snippets"
        ],
        "summary": "List Snippets",
        "description": "List configuration snippets (admin only)",
        "operationId": "list_snippets_api_v1_snippets__get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "items": {
                    "$ref": "#/components/schemas/RemnawaveSnippetResponse"
                  },
                  "type": "array",
                  "title": "Response List Snippets Api V1 Snippets  Get"
                }
              }
            }
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ]
      },
      "post": {
        "tags": [
          "snippets"
        ],
        "summary": "Create Snippet",
        "description": "Create a new configuration snippet (admin only)",
        "operationId": "create_snippet_api_v1_snippets__post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateSnippetRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RemnawaveSnippetResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ]
      }
    },
    "/api/v1/keygen/public-key": {
      "get": {
        "tags": [
          "keygen"
        ],
        "summary": "Get Public Key",
        "description": "Get public key for signature verification",
        "operationId": "get_public_key_api_v1_keygen_public_key_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RemnawavePublicKeyResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ]
      }
    },
    "/api/v1/keygen/sign-payload": {
      "post": {
        "tags": [
          "keygen"
        ],
        "summary": "Sign Payload",
        "description": "Sign a payload with the private key",
        "operationId": "sign_payload_api_v1_keygen_sign_payload_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SignPayloadRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RemnawaveSignPayloadResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ]
      }
    },
    "/api/v1/xray/config": {
      "get": {
        "tags": [
          "xray"
        ],
        "summary": "Get Xray Config",
        "description": "Get current Xray configuration (admin only)",
        "operationId": "get_xray_config_api_v1_xray_config_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RemnawaveXrayConfigResponse"
                }
              }
            }
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ]
      }
    },
    "/api/v1/xray/update-config": {
      "post": {
        "tags": [
          "xray"
        ],
        "summary": "Update Xray Config",
        "description": "Update Xray configuration (admin only)",
        "operationId": "update_xray_config_api_v1_xray_update_config_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateXrayConfigRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RemnawaveXrayConfigResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ]
      }
    },
    "/api/v1/settings/": {
      "get": {
        "tags": [
          "settings"
        ],
        "summary": "Get Settings",
        "description": "Get system settings (admin only)",
        "operationId": "get_settings_api_v1_settings__get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "items": {
                    "$ref": "#/components/schemas/RemnawaveSettingResponse"
                  },
                  "type": "array",
                  "title": "Response Get Settings Api V1 Settings  Get"
                }
              }
            }
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ]
      },
      "post": {
        "tags": [
          "settings"
        ],
        "summary": "Create Setting",
        "description": "Create a new system setting (admin only)",
        "operationId": "create_setting_api_v1_settings__post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateSettingRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RemnawaveSettingResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ]
      }
    },
    "/api/v1/settings/{id}": {
      "put": {
        "tags": [
          "settings"
        ],
        "summary": "Update Setting",
        "description": "Update system setting (admin only)",
        "operationId": "update_setting_api_v1_settings__id__put",
        "security": [
          {
            "HTTPBearer": []
          }
        ],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "title": "Id"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateSettingRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RemnawaveSettingResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/ws/ticket": {
      "post": {
        "tags": [
          "websocket"
        ],
        "summary": "Create Ws Ticket",
        "description": "Create a single-use WebSocket authentication ticket.\n\nThe ticket:\n- Is valid for 30 seconds\n- Can only be used once\n- Contains user context (ID, role)\n- Should be used as ?ticket=<uuid> when connecting to WebSocket\n\nThis prevents JWT tokens from appearing in WebSocket URLs,\nwhich would be logged by servers and proxies.",
        "operationId": "create_ws_ticket_api_v1_ws_ticket_post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WSTicketResponse"
                }
              }
            }
          },
          "401": {
            "description": "Not authenticated"
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ]
      }
    },
    "/.well-known/security.txt": {
      "get": {
        "tags": [
          "well-known"
        ],
        "summary": "Security.txt",
        "description": "Security contact information following RFC 9116",
        "operationId": "security_txt__well_known_security_txt_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "string"
                }
              }
            }
          }
        }
      }
    },
    "/health": {
      "get": {
        "summary": "Health Check",
        "description": "Minimal health check for load balancers and orchestrators.\n\nLOW-008: Returns only status to prevent service identification attacks.\nFor detailed health information, use the authenticated /health/detailed endpoint.",
        "operationId": "health_check_health_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Health Check Health Get"
                }
              }
            }
          }
        }
      }
    },
    "/health/detailed": {
      "get": {
        "summary": "Health Check Detailed",
        "description": "Detailed health check with dependency status (authenticated).\n\nLOW-008: Service identification info only available to authenticated users.\nReturns service name, version, environment, and dependency health.",
        "operationId": "health_check_detailed_health_detailed_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Health Check Detailed Health Detailed Get"
                }
              }
            }
          }
        },
        "security": [
          {
            "HTTPBearer": []
          }
        ]
      }
    },
    "/metrics": {
      "get": {
        "summary": "Metrics Endpoint",
        "description": "Prometheus metrics endpoint.\n\nExposes application metrics for Prometheus scraping.\nLOW-006: Includes websocket_auth_method_total for deprecation tracking.",
        "operationId": "metrics_endpoint_metrics_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "AdminRole": {
        "type": "string",
        "enum": [
          "super_admin",
          "admin",
          "operator",
          "support",
          "viewer"
        ],
        "title": "AdminRole"
      },
      "AdminUserResponse": {
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "title": "Id"
          },
          "login": {
            "type": "string",
            "title": "Login"
          },
          "email": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Email"
          },
          "role": {
            "$ref": "#/components/schemas/AdminRole"
          },
          "telegram_id": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Telegram Id"
          },
          "is_active": {
            "type": "boolean",
            "title": "Is Active"
          },
          "is_email_verified": {
            "type": "boolean",
            "title": "Is Email Verified",
            "default": false
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "title": "Created At"
          }
        },
        "type": "object",
        "required": [
          "id",
          "login",
          "role",
          "is_active",
          "created_at"
        ],
        "title": "AdminUserResponse"
      },
      "AuditLogResponse": {
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "title": "Id"
          },
          "admin_id": {
            "anyOf": [
              {
                "type": "string",
                "format": "uuid"
              },
              {
                "type": "null"
              }
            ],
            "title": "Admin Id"
          },
          "action": {
            "type": "string",
            "title": "Action"
          },
          "entity_type": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Entity Type"
          },
          "entity_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Entity Id"
          },
          "old_value": {
            "anyOf": [
              {
                "additionalProperties": true,
                "type": "object"
              },
              {
                "type": "null"
              }
            ],
            "title": "Old Value"
          },
          "new_value": {
            "anyOf": [
              {
                "additionalProperties": true,
                "type": "object"
              },
              {
                "type": "null"
              }
            ],
            "title": "New Value"
          },
          "ip_address": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Ip Address"
          },
          "user_agent": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "User Agent"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "title": "Created At"
          }
        },
        "type": "object",
        "required": [
          "id",
          "action",
          "created_at"
        ],
        "title": "AuditLogResponse",
        "description": "Response schema for audit log entry."
      },
      "AuthResponse": {
        "properties": {
          "tokens": {
            "$ref": "#/components/schemas/src__presentation__api__v1__mobile_auth__schemas__TokenResponse",
            "description": "Authentication tokens"
          },
          "user": {
            "$ref": "#/components/schemas/UserResponse",
            "description": "User profile data"
          },
          "is_new_user": {
            "type": "boolean",
            "title": "Is New User",
            "description": "True if this is a new registration",
            "default": false
          }
        },
        "type": "object",
        "required": [
          "tokens",
          "user"
        ],
        "title": "AuthResponse",
        "description": "Combined authentication response with tokens and user data.\n\nUsed by login and register endpoints for mobile-optimized single response."
      },
      "BandwidthResponse": {
        "properties": {
          "bytes_in": {
            "type": "integer",
            "title": "Bytes In",
            "description": "Incoming bytes"
          },
          "bytes_out": {
            "type": "integer",
            "title": "Bytes Out",
            "description": "Outgoing bytes"
          },
          "period": {
            "type": "string",
            "enum": [
              "today",
              "week",
              "month"
            ],
            "title": "Period",
            "description": "Time period for analytics"
          }
        },
        "type": "object",
        "required": [
          "bytes_in",
          "bytes_out",
          "period"
        ],
        "title": "BandwidthResponse",
        "description": "Bandwidth usage response."
      },
      "ComponentStatus": {
        "properties": {
          "status": {
            "type": "string",
            "enum": [
              "healthy",
              "unhealthy"
            ],
            "title": "Status",
            "description": "Component health status"
          },
          "message": {
            "type": "string",
            "maxLength": 500,
            "title": "Message",
            "description": "Status message"
          },
          "response_time_ms": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Response Time Ms",
            "description": "Response time in milliseconds"
          }
        },
        "type": "object",
        "required": [
          "status",
          "message"
        ],
        "title": "ComponentStatus",
        "description": "Status information for a single system component."
      },
      "ConfigResponse": {
        "properties": {
          "config_string": {
            "type": "string",
            "maxLength": 5000,
            "title": "Config String",
            "description": "VPN configuration string"
          },
          "client_type": {
            "type": "string",
            "maxLength": 50,
            "title": "Client Type",
            "description": "VPN client type (vless, vmess, etc.)"
          }
        },
        "type": "object",
        "required": [
          "config_string",
          "client_type"
        ],
        "title": "ConfigResponse",
        "description": "Response schema for VPN configuration.",
        "example": {
          "client_type": "vless",
          "config_string": "vless://uuid@server:port?encryption=none&security=tls"
        }
      },
      "CreateConfigProfileRequest": {
        "properties": {
          "name": {
            "type": "string",
            "maxLength": 100,
            "minLength": 1,
            "title": "Name",
            "description": "Profile name"
          },
          "profile_type": {
            "type": "string",
            "maxLength": 50,
            "minLength": 1,
            "title": "Profile Type",
            "description": "Profile type"
          },
          "content": {
            "type": "string",
            "maxLength": 100000,
            "minLength": 1,
            "title": "Content",
            "description": "Profile content/template"
          },
          "is_default": {
            "type": "boolean",
            "title": "Is Default",
            "description": "Whether this is the default profile",
            "default": false
          },
          "description": {
            "anyOf": [
              {
                "type": "string",
                "maxLength": 500
              },
              {
                "type": "null"
              }
            ],
            "title": "Description",
            "description": "Profile description"
          }
        },
        "type": "object",
        "required": [
          "name",
          "profile_type",
          "content"
        ],
        "title": "CreateConfigProfileRequest",
        "description": "Request schema for creating a configuration profile.",
        "example": {
          "content": "# Clash config content here",
          "is_default": false,
          "name": "Mobile Optimized",
          "profile_type": "clash"
        }
      },
      "CreateHostRequest": {
        "properties": {
          "name": {
            "type": "string",
            "maxLength": 100,
            "minLength": 1,
            "title": "Name",
            "description": "Host display name"
          },
          "address": {
            "type": "string",
            "maxLength": 255,
            "minLength": 1,
            "title": "Address",
            "description": "Host address or IP"
          },
          "port": {
            "type": "integer",
            "maximum": 65535.0,
            "minimum": 1.0,
            "title": "Port",
            "description": "Host port"
          },
          "sni": {
            "anyOf": [
              {
                "type": "string",
                "maxLength": 255
              },
              {
                "type": "null"
              }
            ],
            "title": "Sni",
            "description": "Server Name Indication"
          },
          "host_header": {
            "anyOf": [
              {
                "type": "string",
                "maxLength": 255
              },
              {
                "type": "null"
              }
            ],
            "title": "Host Header",
            "description": "HTTP Host header"
          },
          "is_disabled": {
            "type": "boolean",
            "title": "Is Disabled",
            "description": "Whether host is disabled",
            "default": false
          },
          "path": {
            "anyOf": [
              {
                "type": "string",
                "maxLength": 255
              },
              {
                "type": "null"
              }
            ],
            "title": "Path",
            "description": "WebSocket path"
          },
          "alpn": {
            "anyOf": [
              {
                "items": {
                  "type": "string"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "title": "Alpn",
            "description": "ALPN protocols"
          }
        },
        "type": "object",
        "required": [
          "name",
          "address",
          "port"
        ],
        "title": "CreateHostRequest",
        "description": "Request schema for creating a VPN host.",
        "example": {
          "address": "de1.example.com",
          "is_disabled": false,
          "name": "Germany Server 1",
          "port": 443,
          "sni": "cloudflare.com"
        }
      },
      "CreateInviteRequest": {
        "properties": {
          "role": {
            "$ref": "#/components/schemas/AdminRole",
            "description": "Role to assign to the registered user",
            "default": "viewer"
          },
          "email_hint": {
            "anyOf": [
              {
                "type": "string",
                "format": "email"
              },
              {
                "type": "null"
              }
            ],
            "title": "Email Hint",
            "description": "Optional: Restrict invite to specific email address"
          }
        },
        "type": "object",
        "title": "CreateInviteRequest",
        "description": "Request to create an invite token."
      },
      "CreateInviteResponse": {
        "properties": {
          "token": {
            "type": "string",
            "title": "Token",
            "description": "The invite token (UUID format)"
          },
          "role": {
            "type": "string",
            "title": "Role",
            "description": "Role that will be assigned to the user"
          },
          "email_hint": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Email Hint",
            "description": "Email address restriction (if set)"
          },
          "expires_in_hours": {
            "type": "integer",
            "title": "Expires In Hours",
            "description": "Token expiry in hours"
          }
        },
        "type": "object",
        "required": [
          "token",
          "role",
          "expires_in_hours"
        ],
        "title": "CreateInviteResponse",
        "description": "Response containing the generated invite token."
      },
      "CreateInvoiceRequest": {
        "properties": {
          "user_uuid": {
            "type": "string",
            "format": "uuid",
            "title": "User Uuid",
            "description": "User UUID"
          },
          "plan_id": {
            "type": "string",
            "maxLength": 100,
            "title": "Plan Id",
            "description": "Subscription plan identifier"
          },
          "currency": {
            "type": "string",
            "maxLength": 3,
            "minLength": 3,
            "title": "Currency",
            "description": "Currency code (ISO 4217)"
          }
        },
        "type": "object",
        "required": [
          "user_uuid",
          "plan_id",
          "currency"
        ],
        "title": "CreateInvoiceRequest",
        "description": "Request schema for creating a payment invoice.",
        "example": {
          "currency": "USD",
          "plan_id": "premium_monthly",
          "user_uuid": "550e8400-e29b-41d4-a716-446655440000"
        }
      },
      "CreatePaymentRequest": {
        "properties": {
          "user_uuid": {
            "type": "string",
            "maxLength": 255,
            "title": "User Uuid",
            "description": "User UUID"
          },
          "amount": {
            "type": "number",
            "exclusiveMinimum": 0.0,
            "title": "Amount",
            "description": "Payment amount"
          },
          "currency": {
            "type": "string",
            "maxLength": 3,
            "minLength": 3,
            "title": "Currency",
            "description": "Currency code (ISO 4217)"
          },
          "payment_method": {
            "anyOf": [
              {
                "type": "string",
                "maxLength": 50
              },
              {
                "type": "null"
              }
            ],
            "title": "Payment Method",
            "description": "Payment method"
          },
          "metadata": {
            "anyOf": [
              {
                "additionalProperties": true,
                "type": "object"
              },
              {
                "type": "null"
              }
            ],
            "title": "Metadata",
            "description": "Additional payment metadata"
          }
        },
        "type": "object",
        "required": [
          "user_uuid",
          "amount",
          "currency"
        ],
        "title": "CreatePaymentRequest",
        "description": "Request schema for creating a billing payment.",
        "example": {
          "amount": 9.99,
          "currency": "USD",
          "payment_method": "cryptobot",
          "user_uuid": "550e8400-e29b-41d4-a716-446655440000"
        }
      },
      "CreatePlanRequest": {
        "properties": {
          "name": {
            "type": "string",
            "maxLength": 100,
            "minLength": 1,
            "title": "Name",
            "description": "Plan name"
          },
          "price": {
            "type": "number",
            "minimum": 0.0,
            "title": "Price",
            "description": "Plan price"
          },
          "currency": {
            "type": "string",
            "maxLength": 3,
            "minLength": 3,
            "title": "Currency",
            "description": "Currency code (ISO 4217)"
          },
          "duration_days": {
            "type": "integer",
            "maximum": 3650.0,
            "exclusiveMinimum": 0.0,
            "title": "Duration Days",
            "description": "Plan duration in days"
          },
          "data_limit_gb": {
            "anyOf": [
              {
                "type": "integer",
                "minimum": 0.0
              },
              {
                "type": "null"
              }
            ],
            "title": "Data Limit Gb",
            "description": "Data limit in GB"
          },
          "max_devices": {
            "anyOf": [
              {
                "type": "integer",
                "maximum": 100.0,
                "minimum": 1.0
              },
              {
                "type": "null"
              }
            ],
            "title": "Max Devices",
            "description": "Max simultaneous devices"
          },
          "features": {
            "anyOf": [
              {
                "items": {
                  "type": "string"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "title": "Features",
            "description": "List of plan features"
          },
          "is_active": {
            "type": "boolean",
            "title": "Is Active",
            "description": "Whether plan is active",
            "default": true
          }
        },
        "type": "object",
        "required": [
          "name",
          "price",
          "currency",
          "duration_days"
        ],
        "title": "CreatePlanRequest",
        "description": "Request schema for creating a subscription plan.",
        "example": {
          "currency": "USD",
          "data_limit_gb": 100,
          "duration_days": 30,
          "name": "Premium Monthly",
          "price": 9.99
        }
      },
      "CreateServerRequest": {
        "properties": {
          "name": {
            "type": "string",
            "maxLength": 100,
            "minLength": 1,
            "title": "Name"
          },
          "address": {
            "type": "string",
            "maxLength": 255,
            "minLength": 1,
            "title": "Address"
          },
          "port": {
            "type": "integer",
            "maximum": 65535.0,
            "minimum": 1.0,
            "title": "Port"
          }
        },
        "type": "object",
        "required": [
          "name",
          "address",
          "port"
        ],
        "title": "CreateServerRequest",
        "description": "Request schema for creating a new server."
      },
      "CreateSettingRequest": {
        "properties": {
          "key": {
            "type": "string",
            "maxLength": 100,
            "minLength": 1,
            "title": "Key",
            "description": "Setting key"
          },
          "value": {
            "title": "Value",
            "description": "Setting value (any JSON type)"
          },
          "description": {
            "anyOf": [
              {
                "type": "string",
                "maxLength": 500
              },
              {
                "type": "null"
              }
            ],
            "title": "Description",
            "description": "Setting description"
          },
          "is_public": {
            "type": "boolean",
            "title": "Is Public",
            "description": "Whether setting is publicly readable",
            "default": false
          }
        },
        "type": "object",
        "required": [
          "key",
          "value"
        ],
        "title": "CreateSettingRequest",
        "description": "Request schema for creating a system setting.",
        "example": {
          "description": "Maximum devices allowed per user",
          "key": "max_devices_per_user",
          "value": 5
        }
      },
      "CreateSnippetRequest": {
        "properties": {
          "name": {
            "type": "string",
            "maxLength": 100,
            "minLength": 1,
            "title": "Name",
            "description": "Snippet name"
          },
          "snippet_type": {
            "type": "string",
            "maxLength": 50,
            "minLength": 1,
            "title": "Snippet Type",
            "description": "Snippet type"
          },
          "content": {
            "type": "string",
            "maxLength": 50000,
            "minLength": 1,
            "title": "Content",
            "description": "Snippet content"
          },
          "is_active": {
            "type": "boolean",
            "title": "Is Active",
            "description": "Whether snippet is active",
            "default": true
          },
          "order": {
            "anyOf": [
              {
                "type": "integer",
                "minimum": 0.0
              },
              {
                "type": "null"
              }
            ],
            "title": "Order",
            "description": "Display/execution order"
          }
        },
        "type": "object",
        "required": [
          "name",
          "snippet_type",
          "content"
        ],
        "title": "CreateSnippetRequest",
        "description": "Request schema for creating a configuration snippet.",
        "example": {
          "content": "Host: cloudflare.com",
          "is_active": true,
          "name": "CDN Headers",
          "snippet_type": "header"
        }
      },
      "CreateSquadRequest": {
        "properties": {
          "name": {
            "type": "string",
            "maxLength": 100,
            "minLength": 1,
            "title": "Name",
            "description": "Squad name"
          },
          "squad_type": {
            "type": "string",
            "maxLength": 50,
            "minLength": 1,
            "title": "Squad Type",
            "description": "Squad type (internal/external)"
          },
          "max_members": {
            "anyOf": [
              {
                "type": "integer",
                "maximum": 10000.0,
                "minimum": 1.0
              },
              {
                "type": "null"
              }
            ],
            "title": "Max Members",
            "description": "Maximum squad members"
          },
          "is_active": {
            "type": "boolean",
            "title": "Is Active",
            "description": "Whether squad is active",
            "default": true
          },
          "description": {
            "anyOf": [
              {
                "type": "string",
                "maxLength": 500
              },
              {
                "type": "null"
              }
            ],
            "title": "Description",
            "description": "Squad description"
          }
        },
        "type": "object",
        "required": [
          "name",
          "squad_type"
        ],
        "title": "CreateSquadRequest",
        "description": "Request schema for creating a squad.",
        "example": {
          "is_active": true,
          "max_members": 100,
          "name": "Premium Users",
          "squad_type": "internal"
        }
      },
      "CreateSubscriptionRequest": {
        "properties": {
          "plan_name": {
            "type": "string",
            "maxLength": 100,
            "title": "Plan Name",
            "description": "Name of the subscription plan"
          },
          "duration_days": {
            "type": "integer",
            "maximum": 3650.0,
            "exclusiveMinimum": 0.0,
            "title": "Duration Days",
            "description": "Subscription duration in days"
          }
        },
        "type": "object",
        "required": [
          "plan_name",
          "duration_days"
        ],
        "title": "CreateSubscriptionRequest",
        "description": "Request schema for creating a subscription.",
        "example": {
          "duration_days": 30,
          "plan_name": "Premium Monthly"
        }
      },
      "CreateSubscriptionTemplateRequest": {
        "properties": {
          "name": {
            "type": "string",
            "maxLength": 100,
            "minLength": 1,
            "title": "Name",
            "description": "Template name"
          },
          "template_type": {
            "type": "string",
            "maxLength": 50,
            "minLength": 1,
            "title": "Template Type",
            "description": "VPN client template type"
          },
          "host_uuid": {
            "anyOf": [
              {
                "type": "string",
                "maxLength": 255
              },
              {
                "type": "null"
              }
            ],
            "title": "Host Uuid",
            "description": "Host UUID"
          },
          "inbound_tag": {
            "anyOf": [
              {
                "type": "string",
                "maxLength": 100
              },
              {
                "type": "null"
              }
            ],
            "title": "Inbound Tag",
            "description": "Inbound tag"
          },
          "flow": {
            "anyOf": [
              {
                "type": "string",
                "maxLength": 50
              },
              {
                "type": "null"
              }
            ],
            "title": "Flow",
            "description": "Flow control method"
          },
          "config_data": {
            "anyOf": [
              {
                "additionalProperties": true,
                "type": "object"
              },
              {
                "type": "null"
              }
            ],
            "title": "Config Data",
            "description": "Additional config data"
          }
        },
        "type": "object",
        "required": [
          "name",
          "template_type"
        ],
        "title": "CreateSubscriptionTemplateRequest",
        "description": "Request schema for creating a subscription template.",
        "example": {
          "flow": "xtls-rprx-vision",
          "host_uuid": "550e8400-e29b-41d4-a716-446655440000",
          "inbound_tag": "vless-in",
          "name": "Standard VPN Config",
          "template_type": "v2ray"
        }
      },
      "CreateUserRequest": {
        "properties": {
          "username": {
            "type": "string",
            "maxLength": 50,
            "minLength": 3,
            "title": "Username"
          },
          "password": {
            "anyOf": [
              {
                "type": "string",
                "maxLength": 255
              },
              {
                "type": "null"
              }
            ],
            "title": "Password"
          },
          "email": {
            "anyOf": [
              {
                "type": "string",
                "format": "email"
              },
              {
                "type": "null"
              }
            ],
            "title": "Email"
          },
          "data_limit": {
            "anyOf": [
              {
                "type": "integer",
                "maximum": 1099511627776.0,
                "minimum": 0.0
              },
              {
                "type": "null"
              }
            ],
            "title": "Data Limit"
          },
          "expire_at": {
            "anyOf": [
              {
                "type": "string",
                "format": "date-time"
              },
              {
                "type": "null"
              }
            ],
            "title": "Expire At"
          }
        },
        "type": "object",
        "required": [
          "username"
        ],
        "title": "CreateUserRequest",
        "description": "Request schema for creating a new VPN user."
      },
      "DeleteAccountResponse": {
        "properties": {
          "message": {
            "type": "string",
            "title": "Message",
            "default": "Account has been deleted"
          }
        },
        "type": "object",
        "title": "DeleteAccountResponse",
        "description": "Response for successful account deletion (FEAT-03)."
      },
      "DeviceInfo": {
        "properties": {
          "device_id": {
            "type": "string",
            "maxLength": 36,
            "minLength": 36,
            "title": "Device Id",
            "description": "Unique device identifier (UUID generated client-side)"
          },
          "platform": {
            "$ref": "#/components/schemas/Platform",
            "description": "Mobile platform (ios/android)"
          },
          "platform_id": {
            "type": "string",
            "maxLength": 255,
            "minLength": 1,
            "title": "Platform Id",
            "description": "Platform-specific identifier (vendor ID for iOS, Android ID)"
          },
          "os_version": {
            "type": "string",
            "maxLength": 20,
            "minLength": 1,
            "title": "Os Version",
            "description": "Operating system version (e.g., '17.2', '14.0')"
          },
          "app_version": {
            "type": "string",
            "maxLength": 20,
            "minLength": 1,
            "title": "App Version",
            "description": "CyberVPN app version (e.g., '1.0.0')"
          },
          "device_model": {
            "type": "string",
            "maxLength": 100,
            "minLength": 1,
            "title": "Device Model",
            "description": "Device model name (e.g., 'iPhone 15 Pro', 'Pixel 8')"
          },
          "push_token": {
            "anyOf": [
              {
                "type": "string",
                "maxLength": 512
              },
              {
                "type": "null"
              }
            ],
            "title": "Push Token",
            "description": "Firebase Cloud Messaging token for push notifications"
          }
        },
        "type": "object",
        "required": [
          "device_id",
          "platform",
          "platform_id",
          "os_version",
          "app_version",
          "device_model"
        ],
        "title": "DeviceInfo",
        "description": "Device information for mobile authentication.\n\nCaptures device fingerprint for session management and analytics."
      },
      "DeviceRegistrationRequest": {
        "properties": {
          "device": {
            "$ref": "#/components/schemas/DeviceInfo",
            "description": "Device information to register or update"
          }
        },
        "type": "object",
        "required": [
          "device"
        ],
        "title": "DeviceRegistrationRequest",
        "description": "Request schema for device registration/update.\n\nUsed by POST /api/v1/mobile/auth/device endpoint."
      },
      "DeviceResponse": {
        "properties": {
          "device_id": {
            "type": "string",
            "title": "Device Id",
            "description": "Registered device ID"
          },
          "registered_at": {
            "type": "string",
            "format": "date-time",
            "title": "Registered At",
            "description": "Device registration timestamp"
          },
          "last_active_at": {
            "anyOf": [
              {
                "type": "string",
                "format": "date-time"
              },
              {
                "type": "null"
              }
            ],
            "title": "Last Active At",
            "description": "Last activity timestamp"
          }
        },
        "type": "object",
        "required": [
          "device_id",
          "registered_at"
        ],
        "title": "DeviceResponse",
        "description": "Response schema for device registration.\n\nReturned by device registration endpoint."
      },
      "ForgotPasswordRequest": {
        "properties": {
          "email": {
            "type": "string",
            "format": "email",
            "title": "Email"
          }
        },
        "type": "object",
        "required": [
          "email"
        ],
        "title": "ForgotPasswordRequest",
        "description": "Request for password reset OTP."
      },
      "ForgotPasswordResponse": {
        "properties": {
          "message": {
            "type": "string",
            "title": "Message",
            "default": "If this email is registered, a password reset code has been sent."
          }
        },
        "type": "object",
        "title": "ForgotPasswordResponse",
        "description": "Response for forgot-password (always same to prevent email enumeration)."
      },
      "GenerateLoginLinkRequest": {
        "properties": {
          "telegram_id": {
            "type": "integer",
            "exclusiveMinimum": 0.0,
            "title": "Telegram Id"
          }
        },
        "type": "object",
        "required": [
          "telegram_id"
        ],
        "title": "GenerateLoginLinkRequest",
        "description": "Request to generate a Telegram bot login link (admin/bot-only)."
      },
      "GenerateLoginLinkResponse": {
        "properties": {
          "token": {
            "type": "string",
            "title": "Token"
          },
          "url": {
            "type": "string",
            "title": "Url"
          },
          "expires_at": {
            "type": "string",
            "format": "date-time",
            "title": "Expires At"
          }
        },
        "type": "object",
        "required": [
          "token",
          "url",
          "expires_at"
        ],
        "title": "GenerateLoginLinkResponse",
        "description": "Response with the generated Telegram bot login link."
      },
      "GitHubCallbackRequest": {
        "properties": {
          "code": {
            "type": "string",
            "title": "Code",
            "description": "Authorization code from GitHub"
          },
          "state": {
            "type": "string",
            "title": "State",
            "description": "OAuth state token for CSRF protection"
          },
          "redirect_uri": {
            "type": "string",
            "title": "Redirect Uri",
            "description": "Redirect URI used in authorization"
          }
        },
        "type": "object",
        "required": [
          "code",
          "state",
          "redirect_uri"
        ],
        "title": "GitHubCallbackRequest",
        "description": "GitHub OAuth callback request."
      },
      "HTTPValidationError": {
        "properties": {
          "detail": {
            "items": {
              "$ref": "#/components/schemas/ValidationError"
            },
            "type": "array",
            "title": "Detail"
          }
        },
        "type": "object",
        "title": "HTTPValidationError"
      },
      "HealthResponse": {
        "properties": {
          "status": {
            "type": "string",
            "enum": [
              "healthy",
              "unhealthy",
              "degraded"
            ],
            "title": "Status",
            "description": "Overall system status"
          },
          "components": {
            "additionalProperties": {
              "$ref": "#/components/schemas/ComponentStatus"
            },
            "type": "object",
            "title": "Components",
            "description": "Status of individual components"
          },
          "timestamp": {
            "type": "string",
            "format": "date-time",
            "title": "Timestamp",
            "description": "Timestamp of health check"
          }
        },
        "type": "object",
        "required": [
          "status"
        ],
        "title": "HealthResponse",
        "description": "Overall system health check response."
      },
      "HostResponse": {
        "properties": {
          "uuid": {
            "type": "string",
            "title": "Uuid",
            "description": "Host UUID"
          },
          "name": {
            "type": "string",
            "maxLength": 100,
            "title": "Name",
            "description": "Host display name"
          },
          "address": {
            "type": "string",
            "maxLength": 255,
            "title": "Address",
            "description": "Host address"
          },
          "port": {
            "type": "integer",
            "title": "Port",
            "description": "Host port"
          },
          "sni": {
            "anyOf": [
              {
                "type": "string",
                "maxLength": 255
              },
              {
                "type": "null"
              }
            ],
            "title": "Sni",
            "description": "SNI"
          },
          "host_header": {
            "anyOf": [
              {
                "type": "string",
                "maxLength": 255
              },
              {
                "type": "null"
              }
            ],
            "title": "Host Header",
            "description": "Host header"
          },
          "is_disabled": {
            "type": "boolean",
            "title": "Is Disabled",
            "description": "Whether host is disabled"
          },
          "path": {
            "anyOf": [
              {
                "type": "string",
                "maxLength": 255
              },
              {
                "type": "null"
              }
            ],
            "title": "Path",
            "description": "WebSocket path"
          },
          "alpn": {
            "anyOf": [
              {
                "items": {
                  "type": "string"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "title": "Alpn",
            "description": "ALPN protocols"
          }
        },
        "type": "object",
        "required": [
          "uuid",
          "name",
          "address",
          "port",
          "is_disabled"
        ],
        "title": "HostResponse",
        "description": "Expected response from Remnawave hosts API."
      },
      "InviteTokenInfo": {
        "properties": {
          "token": {
            "type": "string",
            "title": "Token"
          },
          "role": {
            "type": "string",
            "title": "Role"
          },
          "email_hint": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Email Hint"
          },
          "created_by": {
            "type": "string",
            "title": "Created By"
          },
          "created_at": {
            "type": "string",
            "title": "Created At"
          },
          "ttl_seconds": {
            "type": "integer",
            "title": "Ttl Seconds"
          }
        },
        "type": "object",
        "required": [
          "token",
          "role",
          "email_hint",
          "created_by",
          "created_at",
          "ttl_seconds"
        ],
        "title": "InviteTokenInfo",
        "description": "Information about an invite token."
      },
      "InvoiceResponse": {
        "properties": {
          "invoice_id": {
            "type": "string",
            "title": "Invoice Id",
            "description": "Unique invoice identifier"
          },
          "payment_url": {
            "type": "string",
            "maxLength": 2000,
            "title": "Payment Url",
            "description": "URL for payment processing"
          },
          "amount": {
            "type": "number",
            "exclusiveMinimum": 0.0,
            "title": "Amount",
            "description": "Invoice amount"
          },
          "currency": {
            "type": "string",
            "title": "Currency",
            "description": "Currency code (ISO 4217)"
          },
          "status": {
            "type": "string",
            "title": "Status",
            "description": "Invoice status (pending, paid, expired)"
          },
          "expires_at": {
            "type": "string",
            "format": "date-time",
            "title": "Expires At",
            "description": "Invoice expiration timestamp"
          }
        },
        "type": "object",
        "required": [
          "invoice_id",
          "payment_url",
          "amount",
          "currency",
          "status",
          "expires_at"
        ],
        "title": "InvoiceResponse",
        "description": "Response schema for payment invoice.",
        "example": {
          "amount": 9.99,
          "currency": "USD",
          "expires_at": "2024-01-29T12:00:00",
          "invoice_id": "inv_1234567890",
          "payment_url": "https://payment.provider.com/pay/inv_1234567890",
          "status": "pending"
        }
      },
      "ListInvitesResponse": {
        "properties": {
          "invites": {
            "items": {
              "$ref": "#/components/schemas/InviteTokenInfo"
            },
            "type": "array",
            "title": "Invites"
          },
          "total": {
            "type": "integer",
            "title": "Total"
          }
        },
        "type": "object",
        "required": [
          "invites",
          "total"
        ],
        "title": "ListInvitesResponse",
        "description": "Response containing list of active invites."
      },
      "LoginRequest": {
        "properties": {
          "login_or_email": {
            "type": "string",
            "maxLength": 255,
            "minLength": 1,
            "title": "Login Or Email"
          },
          "password": {
            "type": "string",
            "maxLength": 255,
            "minLength": 1,
            "title": "Password"
          }
        },
        "type": "object",
        "required": [
          "login_or_email",
          "password"
        ],
        "title": "LoginRequest"
      },
      "LogoutAllResponse": {
        "properties": {
          "message": {
            "type": "string",
            "title": "Message",
            "default": "All sessions terminated"
          },
          "sessions_revoked": {
            "type": "integer",
            "title": "Sessions Revoked",
            "default": 0
          }
        },
        "type": "object",
        "title": "LogoutAllResponse",
        "description": "Response for logout-all-devices operation (HIGH-6)."
      },
      "LogoutRequest": {
        "properties": {
          "refresh_token": {
            "type": "string",
            "minLength": 1,
            "title": "Refresh Token",
            "description": "Refresh token to revoke"
          },
          "device_id": {
            "type": "string",
            "maxLength": 36,
            "minLength": 36,
            "title": "Device Id",
            "description": "Device ID for session revocation"
          }
        },
        "type": "object",
        "required": [
          "refresh_token",
          "device_id"
        ],
        "title": "LogoutRequest",
        "description": "Request schema for logout.\n\nUsed by POST /api/v1/mobile/auth/logout endpoint."
      },
      "MagicLinkRequest": {
        "properties": {
          "email": {
            "type": "string",
            "format": "email",
            "title": "Email"
          }
        },
        "type": "object",
        "required": [
          "email"
        ],
        "title": "MagicLinkRequest",
        "description": "Request for magic link email."
      },
      "MagicLinkResponse": {
        "properties": {
          "message": {
            "type": "string",
            "title": "Message",
            "default": "If this email is registered, a login link has been sent."
          }
        },
        "type": "object",
        "title": "MagicLinkResponse",
        "description": "Response for magic link request (always same to prevent email enumeration)."
      },
      "MagicLinkVerifyRequest": {
        "properties": {
          "token": {
            "type": "string",
            "maxLength": 200,
            "minLength": 1,
            "title": "Token"
          }
        },
        "type": "object",
        "required": [
          "token"
        ],
        "title": "MagicLinkVerifyRequest",
        "description": "Request to verify magic link token."
      },
      "MobileAuthError": {
        "properties": {
          "code": {
            "type": "string",
            "title": "Code",
            "description": "Error code for client-side handling"
          },
          "message": {
            "type": "string",
            "title": "Message",
            "description": "Human-readable error message"
          },
          "details": {
            "anyOf": [
              {
                "additionalProperties": true,
                "type": "object"
              },
              {
                "type": "null"
              }
            ],
            "title": "Details",
            "description": "Additional error details (e.g., validation errors)"
          }
        },
        "type": "object",
        "required": [
          "code",
          "message"
        ],
        "title": "MobileAuthError",
        "description": "Error response schema for mobile authentication.\n\nStandardized error format for mobile clients."
      },
      "OAuthAuthorizeResponse": {
        "properties": {
          "authorize_url": {
            "type": "string",
            "maxLength": 2000,
            "title": "Authorize Url",
            "description": "OAuth provider authorization URL"
          },
          "state": {
            "type": "string",
            "title": "State",
            "description": "CSRF protection state token (include in callback)"
          }
        },
        "type": "object",
        "required": [
          "authorize_url",
          "state"
        ],
        "title": "OAuthAuthorizeResponse",
        "description": "Response containing OAuth authorization URL and state token."
      },
      "OAuthLinkResponse": {
        "properties": {
          "status": {
            "type": "string",
            "enum": [
              "linked",
              "unlinked"
            ],
            "title": "Status",
            "description": "Link operation result"
          },
          "provider": {
            "type": "string",
            "title": "Provider",
            "description": "OAuth provider name"
          },
          "provider_user_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Provider User Id",
            "description": "User ID from the OAuth provider"
          }
        },
        "type": "object",
        "required": [
          "status",
          "provider"
        ],
        "title": "OAuthLinkResponse",
        "description": "Response for account link/unlink operations."
      },
      "OAuthLoginCallbackRequest": {
        "properties": {
          "code": {
            "type": "string",
            "title": "Code",
            "description": "Authorization code from provider"
          },
          "state": {
            "type": "string",
            "title": "State",
            "description": "CSRF state token"
          },
          "redirect_uri": {
            "type": "string",
            "title": "Redirect Uri",
            "description": "Redirect URI used in authorization"
          }
        },
        "type": "object",
        "required": [
          "code",
          "state",
          "redirect_uri"
        ],
        "title": "OAuthLoginCallbackRequest",
        "description": "OAuth login callback request (unauthenticated)."
      },
      "OAuthLoginResponse": {
        "properties": {
          "access_token": {
            "type": "string",
            "title": "Access Token"
          },
          "refresh_token": {
            "type": "string",
            "title": "Refresh Token"
          },
          "token_type": {
            "type": "string",
            "title": "Token Type",
            "default": "bearer"
          },
          "expires_in": {
            "type": "integer",
            "title": "Expires In",
            "default": 0
          },
          "user": {
            "$ref": "#/components/schemas/OAuthLoginUserResponse"
          },
          "is_new_user": {
            "type": "boolean",
            "title": "Is New User",
            "default": false
          },
          "requires_2fa": {
            "type": "boolean",
            "title": "Requires 2Fa",
            "default": false
          },
          "tfa_token": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Tfa Token"
          }
        },
        "type": "object",
        "required": [
          "access_token",
          "refresh_token",
          "user"
        ],
        "title": "OAuthLoginResponse",
        "description": "Response for OAuth login (unauthenticated)."
      },
      "OAuthLoginUserResponse": {
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "title": "Id"
          },
          "login": {
            "type": "string",
            "title": "Login"
          },
          "email": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Email"
          },
          "is_active": {
            "type": "boolean",
            "title": "Is Active"
          },
          "is_email_verified": {
            "type": "boolean",
            "title": "Is Email Verified",
            "default": false
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "title": "Created At"
          }
        },
        "type": "object",
        "required": [
          "id",
          "login",
          "is_active",
          "created_at"
        ],
        "title": "OAuthLoginUserResponse",
        "description": "User info in OAuth login response."
      },
      "OAuthProvider": {
        "type": "string",
        "enum": [
          "telegram",
          "github",
          "google",
          "discord",
          "apple",
          "microsoft",
          "twitter"
        ],
        "title": "OAuthProvider",
        "description": "Valid OAuth providers (HIGH-7)."
      },
      "PaymentHistoryItem": {
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "title": "Id",
            "description": "Payment record unique identifier"
          },
          "amount": {
            "type": "number",
            "title": "Amount",
            "description": "Payment amount"
          },
          "currency": {
            "type": "string",
            "title": "Currency",
            "description": "Currency code (ISO 4217)"
          },
          "status": {
            "$ref": "#/components/schemas/PaymentStatus",
            "description": "Payment status"
          },
          "provider": {
            "$ref": "#/components/schemas/PaymentProvider",
            "description": "Payment provider name"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "title": "Created At",
            "description": "Payment creation timestamp"
          }
        },
        "type": "object",
        "required": [
          "id",
          "amount",
          "currency",
          "status",
          "provider",
          "created_at"
        ],
        "title": "PaymentHistoryItem",
        "description": "Payment history item.",
        "example": {
          "amount": 9.99,
          "created_at": "2024-01-15T10:30:00",
          "currency": "USD",
          "id": "550e8400-e29b-41d4-a716-446655440000",
          "provider": "stripe",
          "status": "completed"
        }
      },
      "PaymentHistoryResponse": {
        "properties": {
          "payments": {
            "items": {
              "$ref": "#/components/schemas/PaymentHistoryItem"
            },
            "type": "array",
            "title": "Payments",
            "description": "List of payment history items"
          }
        },
        "type": "object",
        "required": [
          "payments"
        ],
        "title": "PaymentHistoryResponse",
        "description": "Response schema for payment history.",
        "example": {
          "payments": [
            {
              "amount": 9.99,
              "created_at": "2024-01-15T10:30:00",
              "currency": "USD",
              "id": "550e8400-e29b-41d4-a716-446655440000",
              "provider": "stripe",
              "status": "completed"
            }
          ]
        }
      },
      "PaymentProvider": {
        "type": "string",
        "enum": [
          "cryptobot",
          "yookassa",
          "stripe"
        ],
        "title": "PaymentProvider"
      },
      "PaymentStatus": {
        "type": "string",
        "enum": [
          "pending",
          "completed",
          "failed",
          "refunded"
        ],
        "title": "PaymentStatus"
      },
      "Platform": {
        "type": "string",
        "enum": [
          "ios",
          "android"
        ],
        "title": "Platform",
        "description": "Mobile platform identifiers."
      },
      "ReauthRequest": {
        "properties": {
          "password": {
            "type": "string",
            "minLength": 1,
            "format": "password",
            "title": "Password",
            "description": "Current password for re-authentication",
            "writeOnly": true
          }
        },
        "type": "object",
        "required": [
          "password"
        ],
        "title": "ReauthRequest",
        "description": "Request for password re-authentication."
      },
      "ReauthResponse": {
        "properties": {
          "message": {
            "type": "string",
            "title": "Message",
            "description": "Success message",
            "default": "Re-authentication successful. You can now perform sensitive operations."
          },
          "valid_for_minutes": {
            "type": "integer",
            "title": "Valid For Minutes",
            "description": "How long the re-authentication is valid",
            "default": 5
          }
        },
        "type": "object",
        "title": "ReauthResponse",
        "description": "Response from successful re-authentication."
      },
      "RefreshTokenRequest": {
        "properties": {
          "refresh_token": {
            "type": "string",
            "maxLength": 1000,
            "minLength": 1,
            "title": "Refresh Token"
          }
        },
        "type": "object",
        "required": [
          "refresh_token"
        ],
        "title": "RefreshTokenRequest"
      },
      "RegisterRequest": {
        "properties": {
          "login": {
            "type": "string",
            "maxLength": 50,
            "minLength": 3,
            "pattern": "^[a-zA-Z0-9_]+$",
            "title": "Login"
          },
          "email": {
            "anyOf": [
              {
                "type": "string",
                "format": "email"
              },
              {
                "type": "null"
              }
            ],
            "title": "Email"
          },
          "password": {
            "type": "string",
            "maxLength": 128,
            "minLength": 12,
            "title": "Password"
          },
          "locale": {
            "type": "string",
            "maxLength": 10,
            "title": "Locale",
            "default": "en-EN"
          }
        },
        "type": "object",
        "required": [
          "login",
          "password"
        ],
        "title": "RegisterRequest",
        "description": "Registration request with strong password policy (MED-001).\n\nUses shared password validator for consistency with mobile auth.\nSupports email+password or login+password (username-only) registration."
      },
      "RegisterResponse": {
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "title": "Id"
          },
          "login": {
            "type": "string",
            "title": "Login"
          },
          "email": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Email"
          },
          "is_active": {
            "type": "boolean",
            "title": "Is Active",
            "default": false
          },
          "is_email_verified": {
            "type": "boolean",
            "title": "Is Email Verified",
            "default": false
          },
          "message": {
            "type": "string",
            "title": "Message",
            "default": "Registration successful."
          }
        },
        "type": "object",
        "required": [
          "id",
          "login"
        ],
        "title": "RegisterResponse",
        "description": "Response for successful registration."
      },
      "RemnavwaveBillingRecordResponse": {
        "properties": {
          "uuid": {
            "type": "string",
            "title": "Uuid",
            "description": "Billing record UUID"
          },
          "userUuid": {
            "type": "string",
            "title": "Useruuid",
            "description": "User UUID"
          },
          "amount": {
            "type": "number",
            "title": "Amount",
            "description": "Payment amount"
          },
          "currency": {
            "type": "string",
            "title": "Currency",
            "description": "Currency code (ISO 4217)"
          },
          "status": {
            "type": "string",
            "title": "Status",
            "description": "Payment status"
          },
          "paymentMethod": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Paymentmethod",
            "description": "Payment method"
          },
          "createdAt": {
            "anyOf": [
              {
                "type": "string",
                "format": "date-time"
              },
              {
                "type": "null"
              }
            ],
            "title": "Createdat",
            "description": "Creation timestamp"
          }
        },
        "type": "object",
        "required": [
          "uuid",
          "userUuid",
          "amount",
          "currency",
          "status"
        ],
        "title": "RemnavwaveBillingRecordResponse",
        "description": "Billing / payment record from Remnawave."
      },
      "RemnavwavePlanResponse": {
        "properties": {
          "uuid": {
            "type": "string",
            "title": "Uuid",
            "description": "Plan UUID"
          },
          "name": {
            "type": "string",
            "title": "Name",
            "description": "Plan display name"
          },
          "price": {
            "type": "number",
            "title": "Price",
            "description": "Plan price"
          },
          "currency": {
            "type": "string",
            "title": "Currency",
            "description": "Currency code (ISO 4217)"
          },
          "durationDays": {
            "type": "integer",
            "title": "Durationdays",
            "description": "Plan duration in days"
          },
          "dataLimitGb": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Datalimitgb",
            "description": "Data limit in gigabytes"
          },
          "maxDevices": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Maxdevices",
            "description": "Max simultaneous devices"
          },
          "features": {
            "anyOf": [
              {
                "items": {
                  "type": "string"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "title": "Features",
            "description": "Plan feature list"
          },
          "isActive": {
            "type": "boolean",
            "title": "Isactive",
            "description": "Plan active flag",
            "default": true
          }
        },
        "type": "object",
        "required": [
          "uuid",
          "name",
          "price",
          "currency",
          "durationDays"
        ],
        "title": "RemnavwavePlanResponse",
        "description": "Subscription plan from Remnawave."
      },
      "RemnawaveConfigProfileResponse": {
        "properties": {
          "uuid": {
            "type": "string",
            "title": "Uuid",
            "description": "Profile UUID"
          },
          "name": {
            "type": "string",
            "title": "Name",
            "description": "Profile name"
          },
          "profileType": {
            "type": "string",
            "title": "Profiletype",
            "description": "Profile type (clash/v2ray/etc.)"
          },
          "content": {
            "type": "string",
            "title": "Content",
            "description": "Profile template content"
          },
          "isDefault": {
            "type": "boolean",
            "title": "Isdefault",
            "description": "Default profile flag",
            "default": false
          },
          "description": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Description",
            "description": "Profile description"
          }
        },
        "type": "object",
        "required": [
          "uuid",
          "name",
          "profileType",
          "content"
        ],
        "title": "RemnawaveConfigProfileResponse",
        "description": "Configuration profile from Remnawave."
      },
      "RemnawaveInboundResponse": {
        "properties": {
          "uuid": {
            "type": "string",
            "title": "Uuid",
            "description": "Inbound UUID"
          },
          "tag": {
            "type": "string",
            "title": "Tag",
            "description": "Inbound tag identifier"
          },
          "protocol": {
            "type": "string",
            "title": "Protocol",
            "description": "Protocol (vless, vmess, trojan, shadowsocks, etc.)"
          },
          "port": {
            "type": "integer",
            "title": "Port",
            "description": "Listening port"
          },
          "network": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Network",
            "description": "Transport network type (tcp, ws, grpc, etc.)"
          },
          "security": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Security",
            "description": "Security type (tls, reality, none)"
          },
          "tls": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Tls",
            "description": "TLS mode"
          },
          "settings": {
            "anyOf": [
              {
                "additionalProperties": true,
                "type": "object"
              },
              {
                "type": "null"
              }
            ],
            "title": "Settings",
            "description": "Raw protocol settings"
          },
          "streamSettings": {
            "anyOf": [
              {
                "additionalProperties": true,
                "type": "object"
              },
              {
                "type": "null"
              }
            ],
            "title": "Streamsettings",
            "description": "Stream/transport settings"
          },
          "sniffing": {
            "anyOf": [
              {
                "additionalProperties": true,
                "type": "object"
              },
              {
                "type": "null"
              }
            ],
            "title": "Sniffing",
            "description": "Sniffing configuration"
          },
          "nodeUuid": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Nodeuuid",
            "description": "Parent node UUID"
          }
        },
        "type": "object",
        "required": [
          "uuid",
          "tag",
          "protocol",
          "port"
        ],
        "title": "RemnawaveInboundResponse",
        "description": "Inbound (protocol listener) from the Remnawave ``/api/inbounds`` endpoint."
      },
      "RemnawavePublicKeyResponse": {
        "properties": {
          "publicKey": {
            "type": "string",
            "title": "Publickey",
            "description": "Public key in PEM format"
          },
          "algorithm": {
            "type": "string",
            "title": "Algorithm",
            "description": "Key algorithm",
            "default": "RS256"
          }
        },
        "type": "object",
        "required": [
          "publicKey"
        ],
        "title": "RemnawavePublicKeyResponse",
        "description": "Public key response from Remnawave ``/api/keygen``."
      },
      "RemnawaveSettingResponse": {
        "properties": {
          "id": {
            "type": "integer",
            "title": "Id",
            "description": "Setting ID"
          },
          "key": {
            "type": "string",
            "title": "Key",
            "description": "Setting key"
          },
          "value": {
            "title": "Value",
            "description": "Setting value (any JSON type)"
          },
          "description": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Description",
            "description": "Setting description"
          },
          "isPublic": {
            "type": "boolean",
            "title": "Ispublic",
            "description": "Public visibility flag",
            "default": false
          }
        },
        "type": "object",
        "required": [
          "id",
          "key",
          "value"
        ],
        "title": "RemnawaveSettingResponse",
        "description": "System setting key-value pair from Remnawave."
      },
      "RemnawaveSignPayloadResponse": {
        "properties": {
          "signature": {
            "type": "string",
            "title": "Signature",
            "description": "Generated digital signature"
          },
          "algorithm": {
            "type": "string",
            "title": "Algorithm",
            "description": "Signing algorithm used",
            "default": "RS256"
          }
        },
        "type": "object",
        "required": [
          "signature"
        ],
        "title": "RemnawaveSignPayloadResponse",
        "description": "Signed payload response from Remnawave ``/api/keygen``."
      },
      "RemnawaveSnippetResponse": {
        "properties": {
          "uuid": {
            "type": "string",
            "title": "Uuid",
            "description": "Snippet UUID"
          },
          "name": {
            "type": "string",
            "title": "Name",
            "description": "Snippet name"
          },
          "snippetType": {
            "type": "string",
            "title": "Snippettype",
            "description": "Snippet type"
          },
          "content": {
            "type": "string",
            "title": "Content",
            "description": "Snippet content"
          },
          "isActive": {
            "type": "boolean",
            "title": "Isactive",
            "description": "Active flag",
            "default": true
          },
          "order": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Order",
            "description": "Display/execution order"
          }
        },
        "type": "object",
        "required": [
          "uuid",
          "name",
          "snippetType",
          "content"
        ],
        "title": "RemnawaveSnippetResponse",
        "description": "Configuration snippet from Remnawave."
      },
      "RemnawaveSquadResponse": {
        "properties": {
          "uuid": {
            "type": "string",
            "title": "Uuid",
            "description": "Squad UUID"
          },
          "name": {
            "type": "string",
            "title": "Name",
            "description": "Squad name"
          },
          "squadType": {
            "type": "string",
            "title": "Squadtype",
            "description": "Squad type (internal/external)"
          },
          "maxMembers": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Maxmembers",
            "description": "Maximum squad members"
          },
          "isActive": {
            "type": "boolean",
            "title": "Isactive",
            "description": "Active flag",
            "default": true
          },
          "description": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Description",
            "description": "Squad description"
          },
          "memberCount": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Membercount",
            "description": "Current member count"
          }
        },
        "type": "object",
        "required": [
          "uuid",
          "name",
          "squadType"
        ],
        "title": "RemnawaveSquadResponse",
        "description": "Squad (user group) from Remnawave."
      },
      "RemnawaveSubscriptionConfigResponse": {
        "properties": {
          "config": {
            "type": "string",
            "title": "Config",
            "description": "Generated VPN configuration string"
          },
          "subscriptionUrl": {
            "anyOf": [
              {
                "type": "string",
                "maxLength": 5000
              },
              {
                "type": "null"
              }
            ],
            "title": "Subscriptionurl",
            "description": "Subscription URL for VPN clients"
          }
        },
        "type": "object",
        "required": [
          "config"
        ],
        "title": "RemnawaveSubscriptionConfigResponse",
        "description": "Generated subscription config for a specific user."
      },
      "RemnawaveSubscriptionResponse": {
        "properties": {
          "uuid": {
            "type": "string",
            "title": "Uuid",
            "description": "Subscription template UUID"
          },
          "name": {
            "type": "string",
            "title": "Name",
            "description": "Template display name"
          },
          "templateType": {
            "type": "string",
            "title": "Templatetype",
            "description": "VPN client template type"
          },
          "hostUuid": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Hostuuid",
            "description": "Associated host UUID"
          },
          "inboundTag": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Inboundtag",
            "description": "Inbound tag reference"
          },
          "flow": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Flow",
            "description": "Flow control method (xtls-rprx-vision, etc.)"
          },
          "configData": {
            "anyOf": [
              {
                "additionalProperties": true,
                "type": "object"
              },
              {
                "type": "null"
              }
            ],
            "title": "Configdata",
            "description": "Additional config blob"
          }
        },
        "type": "object",
        "required": [
          "uuid",
          "name",
          "templateType"
        ],
        "title": "RemnawaveSubscriptionResponse",
        "description": "Subscription template from Remnawave."
      },
      "RemnawaveXrayConfigResponse": {
        "properties": {
          "log": {
            "anyOf": [
              {
                "additionalProperties": true,
                "type": "object"
              },
              {
                "type": "null"
              }
            ],
            "title": "Log",
            "description": "Xray log configuration"
          },
          "inbounds": {
            "anyOf": [
              {
                "items": {
                  "additionalProperties": true,
                  "type": "object"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "title": "Inbounds",
            "description": "Xray inbound listeners"
          },
          "outbounds": {
            "anyOf": [
              {
                "items": {
                  "additionalProperties": true,
                  "type": "object"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "title": "Outbounds",
            "description": "Xray outbound proxies"
          },
          "routing": {
            "anyOf": [
              {
                "additionalProperties": true,
                "type": "object"
              },
              {
                "type": "null"
              }
            ],
            "title": "Routing",
            "description": "Xray routing rules"
          },
          "dns": {
            "anyOf": [
              {
                "additionalProperties": true,
                "type": "object"
              },
              {
                "type": "null"
              }
            ],
            "title": "Dns",
            "description": "Xray DNS configuration"
          },
          "policy": {
            "anyOf": [
              {
                "additionalProperties": true,
                "type": "object"
              },
              {
                "type": "null"
              }
            ],
            "title": "Policy",
            "description": "Xray policy configuration"
          }
        },
        "type": "object",
        "title": "RemnawaveXrayConfigResponse",
        "description": "Xray-core configuration blob from Remnawave ``/api/xray/config``."
      },
      "ResendOtpRequest": {
        "properties": {
          "email": {
            "type": "string",
            "format": "email",
            "title": "Email"
          }
        },
        "type": "object",
        "required": [
          "email"
        ],
        "title": "ResendOtpRequest",
        "description": "Request to resend OTP code."
      },
      "ResendOtpResponse": {
        "properties": {
          "message": {
            "type": "string",
            "title": "Message"
          },
          "resends_remaining": {
            "type": "integer",
            "title": "Resends Remaining"
          },
          "next_resend_available_at": {
            "anyOf": [
              {
                "type": "string",
                "format": "date-time"
              },
              {
                "type": "null"
              }
            ],
            "title": "Next Resend Available At"
          }
        },
        "type": "object",
        "required": [
          "message",
          "resends_remaining"
        ],
        "title": "ResendOtpResponse",
        "description": "Response for successful OTP resend."
      },
      "ResetPasswordRequest": {
        "properties": {
          "email": {
            "type": "string",
            "format": "email",
            "title": "Email"
          },
          "code": {
            "type": "string",
            "maxLength": 6,
            "minLength": 6,
            "pattern": "^\\d{6}$",
            "title": "Code"
          },
          "new_password": {
            "type": "string",
            "maxLength": 128,
            "minLength": 12,
            "title": "New Password"
          }
        },
        "type": "object",
        "required": [
          "email",
          "code",
          "new_password"
        ],
        "title": "ResetPasswordRequest",
        "description": "Request to reset password using OTP code."
      },
      "ResetPasswordResponse": {
        "properties": {
          "message": {
            "type": "string",
            "title": "Message",
            "default": "Password has been reset successfully. Please login with your new password."
          }
        },
        "type": "object",
        "title": "ResetPasswordResponse",
        "description": "Response for successful password reset."
      },
      "ServerResponse": {
        "properties": {
          "uuid": {
            "type": "string",
            "format": "uuid",
            "title": "Uuid"
          },
          "name": {
            "type": "string",
            "title": "Name"
          },
          "address": {
            "type": "string",
            "title": "Address"
          },
          "port": {
            "type": "integer",
            "title": "Port"
          },
          "status": {
            "$ref": "#/components/schemas/ServerStatus"
          },
          "is_connected": {
            "type": "boolean",
            "title": "Is Connected"
          },
          "is_disabled": {
            "type": "boolean",
            "title": "Is Disabled"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "title": "Created At"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "title": "Updated At"
          },
          "traffic_used_bytes": {
            "type": "integer",
            "title": "Traffic Used Bytes"
          },
          "inbound_count": {
            "type": "integer",
            "title": "Inbound Count"
          },
          "users_online": {
            "type": "integer",
            "title": "Users Online"
          }
        },
        "type": "object",
        "required": [
          "uuid",
          "name",
          "address",
          "port",
          "status",
          "is_connected",
          "is_disabled",
          "created_at",
          "updated_at",
          "traffic_used_bytes",
          "inbound_count",
          "users_online"
        ],
        "title": "ServerResponse",
        "description": "Response schema for a Remnawave VPN server."
      },
      "ServerStatsResponse": {
        "properties": {
          "online": {
            "type": "integer",
            "title": "Online"
          },
          "offline": {
            "type": "integer",
            "title": "Offline"
          },
          "warning": {
            "type": "integer",
            "title": "Warning"
          },
          "maintenance": {
            "type": "integer",
            "title": "Maintenance"
          },
          "total": {
            "type": "integer",
            "title": "Total"
          }
        },
        "type": "object",
        "required": [
          "online",
          "offline",
          "warning",
          "maintenance",
          "total"
        ],
        "title": "ServerStatsResponse",
        "description": "Response schema for server statistics by status."
      },
      "ServerStatus": {
        "type": "string",
        "enum": [
          "online",
          "offline",
          "warning",
          "maintenance"
        ],
        "title": "ServerStatus"
      },
      "SignPayloadRequest": {
        "properties": {
          "payload": {
            "type": "string",
            "maxLength": 10000,
            "minLength": 1,
            "title": "Payload",
            "description": "Payload to sign"
          },
          "algorithm": {
            "anyOf": [
              {
                "type": "string",
                "maxLength": 20
              },
              {
                "type": "null"
              }
            ],
            "title": "Algorithm",
            "description": "Signing algorithm",
            "default": "RS256"
          }
        },
        "type": "object",
        "required": [
          "payload"
        ],
        "title": "SignPayloadRequest",
        "description": "Request schema for signing a payload.",
        "example": {
          "algorithm": "RS256",
          "payload": "data_to_sign"
        }
      },
      "StatsResponse": {
        "properties": {
          "total_users": {
            "type": "integer",
            "title": "Total Users",
            "description": "Total number of users"
          },
          "active_users": {
            "type": "integer",
            "title": "Active Users",
            "description": "Number of active users"
          },
          "total_servers": {
            "type": "integer",
            "title": "Total Servers",
            "description": "Total number of VPN servers"
          },
          "online_servers": {
            "type": "integer",
            "title": "Online Servers",
            "description": "Number of online servers"
          },
          "total_traffic_bytes": {
            "type": "integer",
            "title": "Total Traffic Bytes",
            "description": "Total traffic in bytes"
          }
        },
        "type": "object",
        "required": [
          "total_users",
          "active_users",
          "total_servers",
          "online_servers",
          "total_traffic_bytes"
        ],
        "title": "StatsResponse",
        "description": "System statistics response."
      },
      "StatusMessageResponse": {
        "properties": {
          "status": {
            "type": "string",
            "title": "Status",
            "description": "Operation status"
          },
          "message": {
            "anyOf": [
              {
                "type": "string",
                "maxLength": 1000
              },
              {
                "type": "null"
              }
            ],
            "title": "Message",
            "description": "Status message"
          }
        },
        "type": "object",
        "required": [
          "status"
        ],
        "title": "StatusMessageResponse",
        "description": "Generic status + message response returned by many mutating endpoints."
      },
      "SubscriptionInfo": {
        "properties": {
          "status": {
            "$ref": "#/components/schemas/SubscriptionStatus",
            "description": "Current subscription status"
          },
          "plan_name": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Plan Name",
            "description": "Name of the subscription plan (if active)"
          },
          "expires_at": {
            "anyOf": [
              {
                "type": "string",
                "format": "date-time"
              },
              {
                "type": "null"
              }
            ],
            "title": "Expires At",
            "description": "Subscription expiration date (if applicable)"
          },
          "traffic_limit_bytes": {
            "anyOf": [
              {
                "type": "integer",
                "minimum": 0.0
              },
              {
                "type": "null"
              }
            ],
            "title": "Traffic Limit Bytes",
            "description": "Traffic limit in bytes (if applicable)"
          },
          "used_traffic_bytes": {
            "anyOf": [
              {
                "type": "integer",
                "minimum": 0.0
              },
              {
                "type": "null"
              }
            ],
            "title": "Used Traffic Bytes",
            "description": "Used traffic in bytes (if applicable)"
          },
          "auto_renew": {
            "type": "boolean",
            "title": "Auto Renew",
            "description": "Whether subscription auto-renews",
            "default": false
          }
        },
        "type": "object",
        "required": [
          "status"
        ],
        "title": "SubscriptionInfo",
        "description": "User subscription information.\n\nIncluded in authentication responses for mobile-optimized data loading."
      },
      "SubscriptionStatus": {
        "type": "string",
        "enum": [
          "active",
          "expired",
          "trial",
          "cancelled",
          "none"
        ],
        "title": "SubscriptionStatus",
        "description": "User subscription status."
      },
      "TelegramAuthRequest": {
        "properties": {
          "auth_data": {
            "type": "string",
            "minLength": 1,
            "title": "Auth Data",
            "description": "Base64-encoded Telegram auth data. Contains: id, first_name, username, photo_url, auth_date, hash"
          },
          "device": {
            "$ref": "#/components/schemas/DeviceInfo",
            "description": "Device information for registration"
          }
        },
        "type": "object",
        "required": [
          "auth_data",
          "device"
        ],
        "title": "TelegramAuthRequest",
        "description": "Request schema for Telegram OAuth callback.\n\nUsed by POST /api/v1/mobile/auth/telegram/callback endpoint."
      },
      "TelegramBotLinkRequest": {
        "properties": {
          "token": {
            "type": "string",
            "maxLength": 200,
            "minLength": 1,
            "title": "Token"
          }
        },
        "type": "object",
        "required": [
          "token"
        ],
        "title": "TelegramBotLinkRequest",
        "description": "Request for Telegram bot deep-link authentication."
      },
      "TelegramBotLinkResponse": {
        "properties": {
          "access_token": {
            "type": "string",
            "title": "Access Token"
          },
          "refresh_token": {
            "type": "string",
            "title": "Refresh Token"
          },
          "token_type": {
            "type": "string",
            "title": "Token Type",
            "default": "bearer"
          },
          "expires_in": {
            "type": "integer",
            "title": "Expires In",
            "default": 0
          },
          "user": {
            "$ref": "#/components/schemas/AdminUserResponse"
          }
        },
        "type": "object",
        "required": [
          "access_token",
          "refresh_token",
          "user"
        ],
        "title": "TelegramBotLinkResponse",
        "description": "Response for Telegram bot deep-link authentication."
      },
      "TelegramCallbackRequest": {
        "properties": {
          "id": {
            "type": "string",
            "title": "Id",
            "description": "Telegram user ID"
          },
          "first_name": {
            "type": "string",
            "title": "First Name",
            "description": "User's first name"
          },
          "last_name": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Last Name",
            "description": "User's last name"
          },
          "username": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Username",
            "description": "Telegram username"
          },
          "photo_url": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Photo Url",
            "description": "Profile photo URL"
          },
          "auth_date": {
            "type": "string",
            "title": "Auth Date",
            "description": "Unix timestamp of authentication"
          },
          "hash": {
            "type": "string",
            "title": "Hash",
            "description": "HMAC-SHA256 signature for validation"
          },
          "state": {
            "type": "string",
            "title": "State",
            "description": "OAuth state token for CSRF protection"
          }
        },
        "type": "object",
        "required": [
          "id",
          "first_name",
          "auth_date",
          "hash",
          "state"
        ],
        "title": "TelegramCallbackRequest",
        "description": "Telegram OAuth callback data.\n\nContains all fields sent by Telegram Login Widget.\nThe hash field is used to validate the data integrity."
      },
      "TelegramMiniAppRequest": {
        "properties": {
          "init_data": {
            "type": "string",
            "maxLength": 4096,
            "minLength": 1,
            "title": "Init Data"
          }
        },
        "type": "object",
        "required": [
          "init_data"
        ],
        "title": "TelegramMiniAppRequest",
        "description": "Request for Telegram Mini App authentication."
      },
      "TelegramMiniAppResponse": {
        "properties": {
          "access_token": {
            "type": "string",
            "title": "Access Token"
          },
          "refresh_token": {
            "type": "string",
            "title": "Refresh Token"
          },
          "token_type": {
            "type": "string",
            "title": "Token Type",
            "default": "bearer"
          },
          "expires_in": {
            "type": "integer",
            "title": "Expires In",
            "default": 0
          },
          "user": {
            "$ref": "#/components/schemas/AdminUserResponse"
          },
          "is_new_user": {
            "type": "boolean",
            "title": "Is New User",
            "default": false
          }
        },
        "type": "object",
        "required": [
          "access_token",
          "refresh_token",
          "user"
        ],
        "title": "TelegramMiniAppResponse",
        "description": "Response for Telegram Mini App authentication."
      },
      "TelegramUserResponse": {
        "properties": {
          "uuid": {
            "type": "string",
            "format": "uuid",
            "title": "Uuid",
            "description": "User unique identifier"
          },
          "username": {
            "type": "string",
            "maxLength": 100,
            "title": "Username",
            "description": "Username"
          },
          "status": {
            "type": "string",
            "maxLength": 50,
            "title": "Status",
            "description": "User account status"
          },
          "data_usage": {
            "type": "integer",
            "title": "Data Usage",
            "description": "Current data usage in bytes"
          },
          "data_limit": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Data Limit",
            "description": "Data limit in bytes"
          },
          "expires_at": {
            "anyOf": [
              {
                "type": "string",
                "format": "date-time"
              },
              {
                "type": "null"
              }
            ],
            "title": "Expires At",
            "description": "Subscription expiration date"
          },
          "subscription_url": {
            "anyOf": [
              {
                "type": "string",
                "maxLength": 5000
              },
              {
                "type": "null"
              }
            ],
            "title": "Subscription Url",
            "description": "VPN subscription configuration URL"
          }
        },
        "type": "object",
        "required": [
          "uuid",
          "username",
          "status",
          "data_usage"
        ],
        "title": "TelegramUserResponse",
        "description": "Response schema for Telegram user information.",
        "example": {
          "data_limit": 107374182400,
          "data_usage": 5368709120,
          "expires_at": "2024-12-31T23:59:59",
          "status": "active",
          "subscription_url": "vless://config-string-here",
          "username": "user123",
          "uuid": "550e8400-e29b-41d4-a716-446655440000"
        }
      },
      "TokenResponse": {
        "properties": {
          "access_token": {
            "type": "string",
            "title": "Access Token"
          },
          "refresh_token": {
            "type": "string",
            "title": "Refresh Token"
          },
          "token_type": {
            "type": "string",
            "title": "Token Type",
            "default": "bearer"
          },
          "expires_in": {
            "type": "integer",
            "title": "Expires In",
            "default": 0
          }
        },
        "type": "object",
        "required": [
          "access_token",
          "refresh_token"
        ],
        "title": "TokenResponse"
      },
      "TwoFactorDisableRequest": {
        "properties": {
          "password": {
            "type": "string",
            "minLength": 1,
            "format": "password",
            "title": "Password",
            "description": "Current password",
            "writeOnly": true
          },
          "code": {
            "type": "string",
            "maxLength": 6,
            "minLength": 6,
            "pattern": "^\\d{6}$",
            "title": "Code",
            "description": "Current TOTP code to confirm disable"
          }
        },
        "type": "object",
        "required": [
          "password",
          "code"
        ],
        "title": "TwoFactorDisableRequest",
        "description": "Request to disable 2FA (requires password)."
      },
      "TwoFactorSetupResponse": {
        "properties": {
          "secret": {
            "type": "string",
            "title": "Secret",
            "description": "TOTP secret key"
          },
          "qr_uri": {
            "type": "string",
            "maxLength": 2000,
            "title": "Qr Uri",
            "description": "otpauth:// provisioning URI"
          },
          "message": {
            "type": "string",
            "title": "Message",
            "description": "User instructions",
            "default": "Scan the QR code with your authenticator app, then verify with a code."
          }
        },
        "type": "object",
        "required": [
          "secret",
          "qr_uri"
        ],
        "title": "TwoFactorSetupResponse",
        "description": "Response from 2FA setup containing secret and provisioning info."
      },
      "TwoFactorStatusResponse": {
        "properties": {
          "status": {
            "type": "string",
            "enum": [
              "enabled",
              "disabled"
            ],
            "title": "Status",
            "description": "2FA status"
          },
          "recovery_codes": {
            "anyOf": [
              {
                "items": {
                  "type": "string"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "title": "Recovery Codes",
            "description": "One-time recovery codes (only shown once when disabling)"
          }
        },
        "type": "object",
        "required": [
          "status"
        ],
        "title": "TwoFactorStatusResponse",
        "description": "Response indicating 2FA enabled/disabled status."
      },
      "TwoFactorValidateResponse": {
        "properties": {
          "valid": {
            "type": "boolean",
            "title": "Valid",
            "description": "Whether the code was valid"
          }
        },
        "type": "object",
        "required": [
          "valid"
        ],
        "title": "TwoFactorValidateResponse",
        "description": "Response from 2FA code validation."
      },
      "TwoFactorVerifyRequest": {
        "properties": {
          "code": {
            "type": "string",
            "maxLength": 6,
            "minLength": 6,
            "pattern": "^\\d{6}$",
            "title": "Code",
            "description": "Six-digit TOTP verification code"
          }
        },
        "type": "object",
        "required": [
          "code"
        ],
        "title": "TwoFactorVerifyRequest",
        "description": "Request to verify 2FA setup and persist secret."
      },
      "UpdateHostRequest": {
        "properties": {
          "name": {
            "anyOf": [
              {
                "type": "string",
                "maxLength": 100,
                "minLength": 1
              },
              {
                "type": "null"
              }
            ],
            "title": "Name"
          },
          "address": {
            "anyOf": [
              {
                "type": "string",
                "maxLength": 255,
                "minLength": 1
              },
              {
                "type": "null"
              }
            ],
            "title": "Address"
          },
          "port": {
            "anyOf": [
              {
                "type": "integer",
                "maximum": 65535.0,
                "minimum": 1.0
              },
              {
                "type": "null"
              }
            ],
            "title": "Port"
          },
          "sni": {
            "anyOf": [
              {
                "type": "string",
                "maxLength": 255
              },
              {
                "type": "null"
              }
            ],
            "title": "Sni"
          },
          "host_header": {
            "anyOf": [
              {
                "type": "string",
                "maxLength": 255
              },
              {
                "type": "null"
              }
            ],
            "title": "Host Header"
          },
          "is_disabled": {
            "anyOf": [
              {
                "type": "boolean"
              },
              {
                "type": "null"
              }
            ],
            "title": "Is Disabled"
          },
          "path": {
            "anyOf": [
              {
                "type": "string",
                "maxLength": 255
              },
              {
                "type": "null"
              }
            ],
            "title": "Path"
          },
          "alpn": {
            "anyOf": [
              {
                "items": {
                  "type": "string"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "title": "Alpn"
          }
        },
        "type": "object",
        "title": "UpdateHostRequest",
        "description": "Request schema for updating a VPN host."
      },
      "UpdatePlanRequest": {
        "properties": {
          "name": {
            "anyOf": [
              {
                "type": "string",
                "maxLength": 100,
                "minLength": 1
              },
              {
                "type": "null"
              }
            ],
            "title": "Name"
          },
          "price": {
            "anyOf": [
              {
                "type": "number",
                "minimum": 0.0
              },
              {
                "type": "null"
              }
            ],
            "title": "Price"
          },
          "currency": {
            "anyOf": [
              {
                "type": "string",
                "maxLength": 3,
                "minLength": 3
              },
              {
                "type": "null"
              }
            ],
            "title": "Currency"
          },
          "duration_days": {
            "anyOf": [
              {
                "type": "integer",
                "maximum": 3650.0,
                "exclusiveMinimum": 0.0
              },
              {
                "type": "null"
              }
            ],
            "title": "Duration Days"
          },
          "data_limit_gb": {
            "anyOf": [
              {
                "type": "integer",
                "minimum": 0.0
              },
              {
                "type": "null"
              }
            ],
            "title": "Data Limit Gb"
          },
          "max_devices": {
            "anyOf": [
              {
                "type": "integer",
                "maximum": 100.0,
                "minimum": 1.0
              },
              {
                "type": "null"
              }
            ],
            "title": "Max Devices"
          },
          "features": {
            "anyOf": [
              {
                "items": {
                  "type": "string"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "title": "Features"
          },
          "is_active": {
            "anyOf": [
              {
                "type": "boolean"
              },
              {
                "type": "null"
              }
            ],
            "title": "Is Active"
          }
        },
        "type": "object",
        "title": "UpdatePlanRequest",
        "description": "Request schema for updating a subscription plan."
      },
      "UpdateServerRequest": {
        "properties": {
          "name": {
            "anyOf": [
              {
                "type": "string",
                "maxLength": 100,
                "minLength": 1
              },
              {
                "type": "null"
              }
            ],
            "title": "Name"
          },
          "address": {
            "anyOf": [
              {
                "type": "string",
                "maxLength": 255,
                "minLength": 1
              },
              {
                "type": "null"
              }
            ],
            "title": "Address"
          },
          "port": {
            "anyOf": [
              {
                "type": "integer",
                "maximum": 65535.0,
                "minimum": 1.0
              },
              {
                "type": "null"
              }
            ],
            "title": "Port"
          }
        },
        "type": "object",
        "title": "UpdateServerRequest",
        "description": "Request schema for updating a server."
      },
      "UpdateSettingRequest": {
        "properties": {
          "value": {
            "anyOf": [
              {},
              {
                "type": "null"
              }
            ],
            "title": "Value",
            "description": "New setting value"
          },
          "description": {
            "anyOf": [
              {
                "type": "string",
                "maxLength": 500
              },
              {
                "type": "null"
              }
            ],
            "title": "Description"
          },
          "is_public": {
            "anyOf": [
              {
                "type": "boolean"
              },
              {
                "type": "null"
              }
            ],
            "title": "Is Public"
          }
        },
        "type": "object",
        "title": "UpdateSettingRequest",
        "description": "Request schema for updating a system setting."
      },
      "UpdateSubscriptionTemplateRequest": {
        "properties": {
          "name": {
            "anyOf": [
              {
                "type": "string",
                "maxLength": 100,
                "minLength": 1
              },
              {
                "type": "null"
              }
            ],
            "title": "Name"
          },
          "template_type": {
            "anyOf": [
              {
                "type": "string",
                "maxLength": 50,
                "minLength": 1
              },
              {
                "type": "null"
              }
            ],
            "title": "Template Type"
          },
          "host_uuid": {
            "anyOf": [
              {
                "type": "string",
                "maxLength": 255
              },
              {
                "type": "null"
              }
            ],
            "title": "Host Uuid"
          },
          "inbound_tag": {
            "anyOf": [
              {
                "type": "string",
                "maxLength": 100
              },
              {
                "type": "null"
              }
            ],
            "title": "Inbound Tag"
          },
          "flow": {
            "anyOf": [
              {
                "type": "string",
                "maxLength": 50
              },
              {
                "type": "null"
              }
            ],
            "title": "Flow"
          },
          "config_data": {
            "anyOf": [
              {
                "additionalProperties": true,
                "type": "object"
              },
              {
                "type": "null"
              }
            ],
            "title": "Config Data"
          }
        },
        "type": "object",
        "title": "UpdateSubscriptionTemplateRequest",
        "description": "Request schema for updating a subscription template."
      },
      "UpdateUserRequest": {
        "properties": {
          "username": {
            "anyOf": [
              {
                "type": "string",
                "maxLength": 50,
                "minLength": 3
              },
              {
                "type": "null"
              }
            ],
            "title": "Username"
          },
          "password": {
            "anyOf": [
              {
                "type": "string",
                "maxLength": 255
              },
              {
                "type": "null"
              }
            ],
            "title": "Password"
          },
          "email": {
            "anyOf": [
              {
                "type": "string",
                "format": "email"
              },
              {
                "type": "null"
              }
            ],
            "title": "Email"
          },
          "data_limit": {
            "anyOf": [
              {
                "type": "integer",
                "maximum": 1099511627776.0,
                "minimum": 0.0
              },
              {
                "type": "null"
              }
            ],
            "title": "Data Limit"
          },
          "expire_at": {
            "anyOf": [
              {
                "type": "string",
                "format": "date-time"
              },
              {
                "type": "null"
              }
            ],
            "title": "Expire At"
          }
        },
        "type": "object",
        "title": "UpdateUserRequest",
        "description": "Request schema for updating a VPN user."
      },
      "UpdateXrayConfigRequest": {
        "properties": {
          "log": {
            "anyOf": [
              {
                "additionalProperties": true,
                "type": "object"
              },
              {
                "type": "null"
              }
            ],
            "title": "Log",
            "description": "Xray log configuration"
          },
          "inbounds": {
            "anyOf": [
              {
                "items": {
                  "additionalProperties": true,
                  "type": "object"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "title": "Inbounds",
            "description": "Inbound configurations"
          },
          "outbounds": {
            "anyOf": [
              {
                "items": {
                  "additionalProperties": true,
                  "type": "object"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "title": "Outbounds",
            "description": "Outbound configurations"
          },
          "routing": {
            "anyOf": [
              {
                "additionalProperties": true,
                "type": "object"
              },
              {
                "type": "null"
              }
            ],
            "title": "Routing",
            "description": "Routing rules"
          },
          "dns": {
            "anyOf": [
              {
                "additionalProperties": true,
                "type": "object"
              },
              {
                "type": "null"
              }
            ],
            "title": "Dns",
            "description": "DNS configuration"
          },
          "policy": {
            "anyOf": [
              {
                "additionalProperties": true,
                "type": "object"
              },
              {
                "type": "null"
              }
            ],
            "title": "Policy",
            "description": "Policy configuration"
          }
        },
        "type": "object",
        "title": "UpdateXrayConfigRequest",
        "description": "Request schema for updating Xray configuration.",
        "example": {
          "inbounds": [],
          "log": {
            "loglevel": "warning"
          },
          "outbounds": [],
          "routing": {
            "rules": []
          }
        }
      },
      "UserListResponse": {
        "properties": {
          "users": {
            "items": {
              "$ref": "#/components/schemas/src__presentation__api__v1__users__schemas__UserResponse"
            },
            "type": "array",
            "title": "Users"
          },
          "total": {
            "type": "integer",
            "title": "Total"
          },
          "page": {
            "type": "integer",
            "title": "Page"
          },
          "page_size": {
            "type": "integer",
            "title": "Page Size"
          }
        },
        "type": "object",
        "required": [
          "users",
          "total",
          "page",
          "page_size"
        ],
        "title": "UserListResponse",
        "description": "Response schema for a list of VPN users."
      },
      "UserResponse": {
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "title": "Id",
            "description": "User UUID"
          },
          "email": {
            "type": "string",
            "title": "Email",
            "description": "User email address"
          },
          "username": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Username",
            "description": "Optional username"
          },
          "status": {
            "type": "string",
            "title": "Status",
            "description": "User account status",
            "default": "active"
          },
          "telegram_id": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Telegram Id",
            "description": "Linked Telegram user ID (if connected)"
          },
          "telegram_username": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Telegram Username",
            "description": "Linked Telegram username (if connected)"
          },
          "created_at": {
            "anyOf": [
              {
                "type": "string",
                "format": "date-time"
              },
              {
                "type": "null"
              }
            ],
            "title": "Created At",
            "description": "Account creation timestamp"
          },
          "subscription": {
            "anyOf": [
              {
                "$ref": "#/components/schemas/SubscriptionInfo"
              },
              {
                "type": "null"
              }
            ],
            "description": "Subscription information (included in mobile responses)"
          }
        },
        "type": "object",
        "required": [
          "id",
          "email"
        ],
        "title": "UserResponse",
        "description": "Response schema for authenticated user profile.\n\nUsed by GET /api/v1/mobile/auth/me and included in login/register responses."
      },
      "UserStatus": {
        "type": "string",
        "enum": [
          "active",
          "disabled",
          "limited",
          "expired"
        ],
        "title": "UserStatus"
      },
      "ValidationError": {
        "properties": {
          "loc": {
            "items": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "integer"
                }
              ]
            },
            "type": "array",
            "title": "Location"
          },
          "msg": {
            "type": "string",
            "title": "Message"
          },
          "type": {
            "type": "string",
            "title": "Error Type"
          },
          "input": {
            "title": "Input"
          },
          "ctx": {
            "type": "object",
            "title": "Context"
          }
        },
        "type": "object",
        "required": [
          "loc",
          "msg",
          "type"
        ],
        "title": "ValidationError"
      },
      "VerifyCodeRequest": {
        "properties": {
          "code": {
            "type": "string",
            "maxLength": 6,
            "minLength": 6,
            "pattern": "^\\d{6}$",
            "title": "Code",
            "description": "Six-digit TOTP verification code"
          }
        },
        "type": "object",
        "required": [
          "code"
        ],
        "title": "VerifyCodeRequest",
        "description": "Request schema for verifying a 2FA code.",
        "example": {
          "code": "123456"
        }
      },
      "VerifyOtpRequest": {
        "properties": {
          "email": {
            "type": "string",
            "format": "email",
            "title": "Email"
          },
          "code": {
            "type": "string",
            "maxLength": 6,
            "minLength": 6,
            "pattern": "^\\d{6}$",
            "title": "Code"
          }
        },
        "type": "object",
        "required": [
          "email",
          "code"
        ],
        "title": "VerifyOtpRequest",
        "description": "Request to verify OTP code."
      },
      "VerifyOtpResponse": {
        "properties": {
          "access_token": {
            "type": "string",
            "title": "Access Token"
          },
          "refresh_token": {
            "type": "string",
            "title": "Refresh Token"
          },
          "token_type": {
            "type": "string",
            "title": "Token Type",
            "default": "bearer"
          },
          "expires_in": {
            "type": "integer",
            "title": "Expires In",
            "default": 0
          },
          "user": {
            "$ref": "#/components/schemas/AdminUserResponse"
          }
        },
        "type": "object",
        "required": [
          "access_token",
          "refresh_token",
          "user"
        ],
        "title": "VerifyOtpResponse",
        "description": "Response for successful OTP verification with auto-login."
      },
      "WSTicketResponse": {
        "properties": {
          "ticket": {
            "type": "string",
            "title": "Ticket",
            "description": "Single-use WebSocket ticket (valid for 30 seconds)"
          },
          "expires_in": {
            "type": "integer",
            "title": "Expires In",
            "description": "Seconds until ticket expires",
            "default": 30
          }
        },
        "type": "object",
        "required": [
          "ticket"
        ],
        "title": "WSTicketResponse",
        "description": "Response containing a WebSocket authentication ticket."
      },
      "WebhookLogResponse": {
        "properties": {
          "id": {
            "type": "string",
            "format": "uuid",
            "title": "Id"
          },
          "source": {
            "type": "string",
            "title": "Source"
          },
          "event_type": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Event Type"
          },
          "payload": {
            "additionalProperties": true,
            "type": "object",
            "title": "Payload"
          },
          "is_valid": {
            "anyOf": [
              {
                "type": "boolean"
              },
              {
                "type": "null"
              }
            ],
            "title": "Is Valid"
          },
          "error_message": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Error Message"
          },
          "processed_at": {
            "anyOf": [
              {
                "type": "string",
                "format": "date-time"
              },
              {
                "type": "null"
              }
            ],
            "title": "Processed At"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "title": "Created At"
          }
        },
        "type": "object",
        "required": [
          "id",
          "source",
          "payload",
          "created_at"
        ],
        "title": "WebhookLogResponse",
        "description": "Response schema for webhook log entry."
      },
      "src__presentation__api__v1__auth__schemas__LogoutRequest": {
        "properties": {
          "refresh_token": {
            "type": "string",
            "maxLength": 1000,
            "minLength": 1,
            "title": "Refresh Token"
          }
        },
        "type": "object",
        "required": [
          "refresh_token"
        ],
        "title": "LogoutRequest"
      },
      "src__presentation__api__v1__mobile_auth__schemas__LoginRequest": {
        "properties": {
          "email": {
            "type": "string",
            "format": "email",
            "title": "Email",
            "description": "User email address"
          },
          "password": {
            "type": "string",
            "maxLength": 128,
            "minLength": 1,
            "title": "Password",
            "description": "User password"
          },
          "device": {
            "$ref": "#/components/schemas/DeviceInfo",
            "description": "Device information for login"
          },
          "remember_me": {
            "type": "boolean",
            "title": "Remember Me",
            "description": "If True, extends refresh token TTL to 30 days (default: 7 days)",
            "default": false
          }
        },
        "type": "object",
        "required": [
          "email",
          "password",
          "device"
        ],
        "title": "LoginRequest",
        "description": "Request schema for mobile user login.\n\nUsed by POST /api/v1/mobile/auth/login endpoint."
      },
      "src__presentation__api__v1__mobile_auth__schemas__RefreshTokenRequest": {
        "properties": {
          "refresh_token": {
            "type": "string",
            "minLength": 1,
            "title": "Refresh Token",
            "description": "Current refresh token to exchange for new tokens"
          },
          "device_id": {
            "type": "string",
            "maxLength": 36,
            "minLength": 36,
            "title": "Device Id",
            "description": "Device ID for session validation"
          }
        },
        "type": "object",
        "required": [
          "refresh_token",
          "device_id"
        ],
        "title": "RefreshTokenRequest",
        "description": "Request schema for token refresh.\n\nUsed by POST /api/v1/mobile/auth/refresh endpoint."
      },
      "src__presentation__api__v1__mobile_auth__schemas__RegisterRequest": {
        "properties": {
          "email": {
            "type": "string",
            "format": "email",
            "title": "Email",
            "description": "User email address (must be valid and unique)"
          },
          "password": {
            "type": "string",
            "maxLength": 128,
            "minLength": 12,
            "title": "Password",
            "description": "User password (minimum 12 characters, requires complexity)"
          },
          "device": {
            "$ref": "#/components/schemas/DeviceInfo",
            "description": "Device information for registration"
          }
        },
        "type": "object",
        "required": [
          "email",
          "password",
          "device"
        ],
        "title": "RegisterRequest",
        "description": "Request schema for mobile user registration.\n\nUsed by POST /api/v1/mobile/auth/register endpoint.\nMED-001: Password requirements aligned with admin auth."
      },
      "src__presentation__api__v1__mobile_auth__schemas__TokenResponse": {
        "properties": {
          "access_token": {
            "type": "string",
            "title": "Access Token",
            "description": "JWT access token (TTL: 15 minutes)"
          },
          "refresh_token": {
            "type": "string",
            "title": "Refresh Token",
            "description": "JWT refresh token (TTL: 7 days or 30 days with remember_me)"
          },
          "token_type": {
            "type": "string",
            "title": "Token Type",
            "description": "Token type for Authorization header",
            "default": "Bearer"
          },
          "expires_in": {
            "type": "integer",
            "minimum": 0.0,
            "title": "Expires In",
            "description": "Access token expiration in seconds (default: 15 minutes)",
            "default": 900
          }
        },
        "type": "object",
        "required": [
          "access_token",
          "refresh_token"
        ],
        "title": "TokenResponse",
        "description": "Response schema for authentication tokens.\n\nReturned by login, register, and refresh endpoints."
      },
      "src__presentation__api__v1__users__schemas__UserResponse": {
        "properties": {
          "uuid": {
            "type": "string",
            "format": "uuid",
            "title": "Uuid"
          },
          "username": {
            "type": "string",
            "title": "Username"
          },
          "status": {
            "$ref": "#/components/schemas/UserStatus"
          },
          "short_uuid": {
            "type": "string",
            "title": "Short Uuid"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "title": "Created At"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "title": "Updated At"
          },
          "subscription_uuid": {
            "anyOf": [
              {
                "type": "string",
                "format": "uuid"
              },
              {
                "type": "null"
              }
            ],
            "title": "Subscription Uuid"
          },
          "expire_at": {
            "anyOf": [
              {
                "type": "string",
                "format": "date-time"
              },
              {
                "type": "null"
              }
            ],
            "title": "Expire At"
          },
          "traffic_limit_bytes": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Traffic Limit Bytes"
          },
          "used_traffic_bytes": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Used Traffic Bytes"
          },
          "email": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Email"
          },
          "telegram_id": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Telegram Id"
          }
        },
        "type": "object",
        "required": [
          "uuid",
          "username",
          "status",
          "short_uuid",
          "created_at",
          "updated_at"
        ],
        "title": "UserResponse",
        "description": "Response schema for a single VPN user."
      }
    },
    "securitySchemes": {
      "HTTPBearer": {
        "type": "http",
        "scheme": "bearer"
      }
    }
  },
  "tags": [
    {
      "name": "auth",
      "description": "Authentication (login, register, refresh, logout)"
    },
    {
      "name": "two-factor",
      "description": "Two-factor authentication management"
    },
    {
      "name": "oauth",
      "description": "OAuth social account linking"
    },
    {
      "name": "users",
      "description": "User CRUD operations"
    },
    {
      "name": "servers",
      "description": "VPN server management"
    },
    {
      "name": "monitoring",
      "description": "System health, stats, bandwidth"
    },
    {
      "name": "payments",
      "description": "Crypto payments and invoices"
    },
    {
      "name": "billing",
      "description": "Billing proxy (Remnawave)"
    },
    {
      "name": "plans",
      "description": "Subscription plans (Remnawave proxy)"
    },
    {
      "name": "subscriptions",
      "description": "Subscription templates (Remnawave proxy)"
    },
    {
      "name": "hosts",
      "description": "VPN host management (Remnawave proxy)"
    },
    {
      "name": "config-profiles",
      "description": "Config profiles (Remnawave proxy)"
    },
    {
      "name": "inbounds",
      "description": "Inbound configurations (Remnawave proxy)"
    },
    {
      "name": "squads",
      "description": "Squad management (Remnawave proxy)"
    },
    {
      "name": "snippets",
      "description": "Snippet management (Remnawave proxy)"
    },
    {
      "name": "keygen",
      "description": "Key generation and signing (Remnawave proxy)"
    },
    {
      "name": "xray",
      "description": "Xray VPN config (Remnawave proxy)"
    },
    {
      "name": "settings",
      "description": "System settings (Remnawave proxy)"
    },
    {
      "name": "admin",
      "description": "Audit logs, webhook logs"
    },
    {
      "name": "webhooks",
      "description": "External webhook receivers"
    },
    {
      "name": "telegram",
      "description": "Telegram bot integration"
    },
    {
      "name": "websocket",
      "description": "Real-time WebSocket channels"
    }
  ]
}
